<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>ResultsPane/widgets/ResultsGrid/index.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    
    <h2><a href="index.html">Home</a></h2><h2><a href="https://github.com/Greenman-Pedersen-Inc/voyager.webpack.vehicle" target="_blank" class="menu-item" id="repo_link" >Github Repository</a></h2><h3>Modules</h3><ul><li><a href="module-API.html">API</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-API.html#.getCrashSegmentsHeatmapQuery">getCrashSegmentsHeatmapQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#.getNetworkSegmentData">getNetworkSegmentData</a></li><li data-type='method' style='display: none;'><a href="module-API.html#.getStateBreakdown">getStateBreakdown</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~CreateDetailWhereClause">CreateDetailWhereClause</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~CreateSearchParameters">CreateSearchParameters</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~CreateWhereClause">CreateWhereClause</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~GetAccidentsBySriQuery">GetAccidentsBySriQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~GetClusterHeatmapQuery">GetClusterHeatmapQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~GetCountyHeatmapQuery">GetCountyHeatmapQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~GetCrashDetailsQuery">GetCrashDetailsQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~GetCrashesQuery">GetCrashesQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~GetMuniHeatmapQuery">GetMuniHeatmapQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~GetPersonsQuery">GetPersonsQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~GetSriQuery">GetSriQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~addUserQueries">addUserQueries</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~deleteUserQueries">deleteUserQueries</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~errorHandler">errorHandler</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getCountyBoundaries">getCountyBoundaries</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getCountyBoundingBoxQuery">getCountyBoundingBoxQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getCrash">getCrash</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getCrashDetailQuery">getCrashDetailQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getCrashList">getCrashList</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getData">getData</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getExportRecords">getExportRecords</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getExportRecordsByID">getExportRecordsByID</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getFeedbackFormQuery">getFeedbackFormQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getFullName">getFullName</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getGraphDataQuery">getGraphDataQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getLayerAttributes">getLayerAttributes</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getMPO">getMPO</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getModules">getModules</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getMunicipalBoundingBoxQuery">getMunicipalBoundingBoxQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getMunicipalityBoundaries">getMunicipalityBoundaries</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getNotifications">getNotifications</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getRouteCrashData">getRouteCrashData</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getSRIBreakdown">getSRIBreakdown</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getSRIHistogramQuery">getSRIHistogramQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getSRIUnderlayQuery">getSRIUnderlayQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getSessionInfo">getSessionInfo</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getTable">getTable</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getTopLocations">getTopLocations</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getUserQueries">getUserQueries</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~postData">postData</a></li></ul></li><li><a href="module-AlertBox.html">AlertBox</a></li><li><a href="module-CodeTranslator.html">CodeTranslator</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-CodeTranslator.html#~convertCodeDescription">convertCodeDescription</a></li><li data-type='method' style='display: none;'><a href="module-CodeTranslator.html#~convertFeature">convertFeature</a></li><li data-type='method' style='display: none;'><a href="module-CodeTranslator.html#~convertFeatureObjectValues">convertFeatureObjectValues</a></li><li data-type='method' style='display: none;'><a href="module-CodeTranslator.html#~convertTableCodes">convertTableCodes</a></li><li data-type='method' style='display: none;'><a href="module-CodeTranslator.html#~resolveFieldAlias">resolveFieldAlias</a></li></ul></li><li><a href="module-CrashFilter.html">CrashFilter</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-CrashFilter.html#~clearSearchHighlights">clearSearchHighlights</a></li><li data-type='method' style='display: none;'><a href="module-CrashFilter.html#~getSelectedFilters">getSelectedFilters</a></li><li data-type='method' style='display: none;'><a href="module-CrashFilter.html#~getSelectedJurisdictions">getSelectedJurisdictions</a></li><li data-type='method' style='display: none;'><a href="module-CrashFilter.html#~getSignalsSelectedFilters">getSignalsSelectedFilters</a></li><li data-type='method' style='display: none;'><a href="module-CrashFilter.html#~reset">reset</a></li><li data-type='method' style='display: none;'><a href="module-CrashFilter.html#~searchFilters">searchFilters</a></li><li data-type='method' style='display: none;'><a href="module-CrashFilter.html#~setFilters">setFilters</a></li></ul></li><li><a href="module-CrashMap_widgets_CrashClusters.html">CrashMap/widgets/CrashClusters</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_CrashClusters.html#~addToMap">addToMap</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_CrashClusters.html#~setMinZoom">setMinZoom</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_CrashClusters.html#~update">update</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_CrashClusters.html#~updateSourceData">updateSourceData</a></li></ul></li><li><a href="module-CrashMap_widgets_CrashGrouping.html">CrashMap/widgets/CrashGrouping</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_CrashGrouping.html#~CrashGrouping">CrashGrouping</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_CrashGrouping.html#~addSelectValues">addSelectValues</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_CrashGrouping.html#~removePriorWindows">removePriorWindows</a></li></ul></li><li><a href="module-CrashMap_widgets_CrashGrouping_widgets_BreakdownComparator.html">CrashMap/widgets/CrashGrouping/widgets/BreakdownComparator</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_CrashGrouping_widgets_BreakdownComparator.html#~update">update</a></li></ul></li><li><a href="module-CrashMap_widgets_CrashGrouping_widgets_BreakdownComparator_widgets_BreakdownChart.html">CrashMap/widgets/CrashGrouping/widgets/BreakdownComparator/widgets/BreakdownChart</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_CrashGrouping_widgets_BreakdownComparator_widgets_BreakdownChart.html#~update">update</a></li></ul></li><li><a href="module-CrashMap_widgets_CrashRecordDialog.html">CrashMap/widgets/CrashRecordDialog</a></li><li><a href="module-CrashMap_widgets_CrashSegmentsHeatmap.html">CrashMap/widgets/CrashSegmentsHeatmap</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_CrashSegmentsHeatmap.html#~addToMap">addToMap</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_CrashSegmentsHeatmap.html#~clearVisuals">clearVisuals</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_CrashSegmentsHeatmap.html#~highlightFeature">highlightFeature</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_CrashSegmentsHeatmap.html#~update">update</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_CrashSegmentsHeatmap.html#~updateSourceData">updateSourceData</a></li></ul></li><li><a href="module-CrashMap_widgets_HighlightFeature.html">CrashMap/widgets/HighlightFeature</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_HighlightFeature.html#~clearHighlight">clearHighlight</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_HighlightFeature.html#~makePointData">makePointData</a></li></ul></li><li><a href="module-CrashMap_widgets_JursidictionBoundaries.html">CrashMap/widgets/JursidictionBoundaries</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_JursidictionBoundaries.html#~addToMap">addToMap</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_JursidictionBoundaries.html#~update">update</a></li></ul></li><li><a href="module-CrashMap_widgets_Legend.html">CrashMap/widgets/Legend</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_Legend.html#~addLayerGroup">addLayerGroup</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_Legend.html#~checkXPosition">checkXPosition</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_Legend.html#~checkYPosition">checkYPosition</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_Legend.html#~clear">clear</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_Legend.html#~getPosition">getPosition</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_Legend.html#~hide">hide</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_Legend.html#~resetYPosition">resetYPosition</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_Legend.html#~show">show</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_Legend.html#~update">update</a></li></ul></li><li><a href="module-CrashMap_widgets_LegendCard.html">CrashMap/widgets/LegendCard</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_LegendCard.html#~populateCardEntries">populateCardEntries</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_LegendCard.html#~update">update</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_LegendCard.html#~updateVisibility">updateVisibility</a></li></ul></li><li><a href="module-CrashMap_widgets_LegendCardGroup.html">CrashMap/widgets/LegendCardGroup</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_LegendCardGroup.html#~createLegendScheme">createLegendScheme</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_LegendCardGroup.html#~updateVisibility">updateVisibility</a></li></ul></li><li><a href="module-CrashMap_widgets_MapSources.html">CrashMap/widgets/MapSources</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_MapSources.html#~getHighlightLayerSource">getHighlightLayerSource</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_MapSources.html#~getHighlightLayerSource">getHighlightLayerSource</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_MapSources.html#~getLayerGroupData">getLayerGroupData</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_MapSources.html#~getMapLayerData">getMapLayerData</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_MapSources.html#~getOverlayLayerDefinitions">getOverlayLayerDefinitions</a></li></ul></li><li><a href="module-CrashMap_widgets_Screenshot.html">CrashMap/widgets/Screenshot</a></li><li><a href="module-FeedbackForm.html">FeedbackForm</a></li><li><a href="module-FilterMenu.html">FilterMenu</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-FilterMenu.html#~clearCheckBoxSpinners">clearCheckBoxSpinners</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu.html#~hide">hide</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu.html#~isLoading">isLoading</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu.html#~show">show</a></li></ul></li><li><a href="module-FilterMenu_widgets_CheckboxFilter.html">FilterMenu/widgets/CheckboxFilter</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_CheckboxFilter.html#~checkFilterField">checkFilterField</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_CheckboxFilter.html#~clearTable">clearTable</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_CheckboxFilter.html#~getDescriptionSelections">getDescriptionSelections</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_CheckboxFilter.html#~getSelections">getSelections</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_CheckboxFilter.html#~reset">reset</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_CheckboxFilter.html#~selectEntireTable">selectEntireTable</a></li></ul></li><li><a href="module-FilterMenu_widgets_CheckboxFilter_widgets_CheckBoxRow.html">FilterMenu/widgets/CheckboxFilter/widgets/CheckBoxRow</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_CheckboxFilter_widgets_CheckBoxRow.html#~check">check</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_CheckboxFilter_widgets_CheckBoxRow.html#~disable">disable</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_CheckboxFilter_widgets_CheckBoxRow.html#~uncheck">uncheck</a></li></ul></li><li><a href="module-FilterMenu_widgets_DateSelector.html">FilterMenu/widgets/DateSelector</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector.html#~checkFilterField">checkFilterField</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector.html#~getDescriptionSelections">getDescriptionSelections</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector.html#~getSelections">getSelections</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector.html#~hide">hide</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector.html#~reset">reset</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector.html#~show">show</a></li></ul></li><li><a href="module-FilterMenu_widgets_DateSelector_widgets_ApplyChangesSelector.html">FilterMenu/widgets/DateSelector/widgets/ApplyChangesSelector</a></li><li><a href="module-FilterMenu_widgets_DateSelector_widgets_DateRangeSelector.html">FilterMenu/widgets/DateSelector/widgets/DateRangeSelector</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_DateRangeSelector.html#~checkFilterField">checkFilterField</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_DateRangeSelector.html#~clearDateRangeSelection">clearDateRangeSelection</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_DateRangeSelector.html#~getSelections">getSelections</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_DateRangeSelector.html#~returnRange">returnRange</a></li></ul></li><li><a href="module-FilterMenu_widgets_DateSelector_widgets_MonthSelector.html">FilterMenu/widgets/DateSelector/widgets/MonthSelector</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_MonthSelector.html#~checkFilterField">checkFilterField</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_MonthSelector.html#~clearMonthSelection">clearMonthSelection</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_MonthSelector.html#~getDescriptionSelections">getDescriptionSelections</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_MonthSelector.html#~getSelections">getSelections</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_MonthSelector.html#~highlightMonthsByValues">highlightMonthsByValues</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_MonthSelector.html#~setFilter">setFilter</a></li></ul></li><li><a href="module-FilterMenu_widgets_DateSelector_widgets_YearSelector.html">FilterMenu/widgets/DateSelector/widgets/YearSelector</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_YearSelector.html#~checkFilterField">checkFilterField</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_YearSelector.html#~clearYearSelection">clearYearSelection</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_YearSelector.html#~getDescriptionSelections">getDescriptionSelections</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_YearSelector.html#~getSelections">getSelections</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_YearSelector.html#~highlightYearsByValues">highlightYearsByValues</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_YearSelector.html#~setFilter">setFilter</a></li></ul></li><li><a href="module-FilterMenu_widgets_LocationFilter_widgets_ApplyChangesSelector.html">FilterMenu/widgets/LocationFilter/widgets/ApplyChangesSelector</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_LocationFilter_widgets_ApplyChangesSelector.html#~error">error</a></li></ul></li><li><a href="module-FilterMenu_widgets_LocationFilter_widgets_RadioBoxRow.html">FilterMenu/widgets/LocationFilter/widgets/RadioBoxRow</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_LocationFilter_widgets_RadioBoxRow.html#~reset">reset</a></li></ul></li><li><a href="module-FilterMenu_widgets_MultivehicleFilter.html">FilterMenu/widgets/MultivehicleFilter</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_MultivehicleFilter.html#~checkFilterField">checkFilterField</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_MultivehicleFilter.html#~getDescriptionSelections">getDescriptionSelections</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_MultivehicleFilter.html#~getSelections">getSelections</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_MultivehicleFilter.html#~hide">hide</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_MultivehicleFilter.html#~reset">reset</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_MultivehicleFilter.html#~show">show</a></li></ul></li><li><a href="module-FilterMenu_widgets_MultivehicleFilter_widgets_ApplyChangesSelector.html">FilterMenu/widgets/MultivehicleFilter/widgets/ApplyChangesSelector</a></li><li><a href="module-FilterMenu_widgets_MultivehicleFilter_widgets_SelectDropDown.html">FilterMenu/widgets/MultivehicleFilter/widgets/SelectDropDown</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_MultivehicleFilter_widgets_SelectDropDown.html#~disable">disable</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_MultivehicleFilter_widgets_SelectDropDown.html#~enable">enable</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_MultivehicleFilter_widgets_SelectDropDown.html#~reset">reset</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_MultivehicleFilter_widgets_SelectDropDown.html#~update">update</a></li></ul></li><li><a href="module-FilterSearch.html">FilterSearch</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-FilterSearch.html#~clear">clear</a></li><li data-type='method' style='display: none;'><a href="module-FilterSearch.html#~clearSearchHighlights">clearSearchHighlights</a></li></ul></li><li><a href="module-HomeButton.html">HomeButton</a></li><li><a href="module-Modal.html">Modal</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-Modal.html#~errorHandler">errorHandler</a></li><li data-type='method' style='display: none;'><a href="module-Modal.html#~evaluateZoomVisibility">evaluateZoomVisibility</a></li><li data-type='method' style='display: none;'><a href="module-Modal.html#~remove">remove</a></li><li data-type='method' style='display: none;'><a href="module-Modal.html#~show">show</a></li></ul></li><li></li><li><a href="module-MoveablePopup.html">MoveablePopup</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-MoveablePopup.html#~checkXPosition">checkXPosition</a></li><li data-type='method' style='display: none;'><a href="module-MoveablePopup.html#~checkYPosition">checkYPosition</a></li></ul></li><li><a href="module-OmniSearch.html">OmniSearch</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-OmniSearch.html#~fireCustomQuery">fireCustomQuery</a></li><li data-type='method' style='display: none;'><a href="module-OmniSearch.html#~fireCustomQuery">fireCustomQuery</a></li><li data-type='method' style='display: none;'><a href="module-OmniSearch.html#~hide">hide</a></li><li data-type='method' style='display: none;'><a href="module-OmniSearch.html#~isSearchFilterButtonToggled">isSearchFilterButtonToggled</a></li></ul></li><li><a href="module-OmniSearch_widgets_OmniResult.html">OmniSearch/widgets/OmniResult</a></li><li><a href="module-OmniSearch_widgets_SearchFilterButton.html">OmniSearch/widgets/SearchFilterButton</a></li><li><a href="module-Popup.html">Popup</a></li><li><a href="module-Popup_widgets_PopupGrid.html">Popup/widgets/PopupGrid</a></li><li><a href="module-RadioBoxTable.html">RadioBoxTable</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-RadioBoxTable.html#~reset">reset</a></li><li data-type='method' style='display: none;'><a href="module-RadioBoxTable.html#~update">update</a></li><li data-type='method' style='display: none;'><a href="module-RadioBoxTable.html#~updateSelection">updateSelection</a></li></ul></li><li><a href="module-ResultsPane.html">ResultsPane</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-ResultsPane.html#~resizeResultsTable">resizeResultsTable</a></li></ul></li><li><a href="module-ResultsPane_widgets_AreaTemporalMetrics_widgets_ChartOptions.html">ResultsPane/widgets/AreaTemporalMetrics/widgets/ChartOptions</a></li><li><a href="module-ResultsPane_widgets_AreaTemporalMetrics_widgets_ChartTabs.html">ResultsPane/widgets/AreaTemporalMetrics/widgets/ChartTabs</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_AreaTemporalMetrics_widgets_ChartTabs.html#~getGraphData">getGraphData</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_AreaTemporalMetrics_widgets_ChartTabs.html#~initiateChart">initiateChart</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_AreaTemporalMetrics_widgets_ChartTabs.html#~updateCharts">updateCharts</a></li></ul></li><li><a href="module-ResultsPane_widgets_AreaTemporalMetrics_widgets_SpeedChart.html">ResultsPane/widgets/AreaTemporalMetrics/widgets/SpeedChart</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_AreaTemporalMetrics_widgets_SpeedChart.html#~createChart">createChart</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_AreaTemporalMetrics_widgets_SpeedChart.html#~prepData">prepData</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_AreaTemporalMetrics_widgets_SpeedChart.html#~update">update</a></li></ul></li><li><a href="module-ResultsPane_widgets_AreaTemporalMetrics_widgets_TemporalChart.html">ResultsPane/widgets/AreaTemporalMetrics/widgets/TemporalChart</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_AreaTemporalMetrics_widgets_TemporalChart.html#~createChart">createChart</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_AreaTemporalMetrics_widgets_TemporalChart.html#~prepData">prepData</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_AreaTemporalMetrics_widgets_TemporalChart.html#~update">update</a></li></ul></li><li><a href="module-ResultsPane_widgets_ExportCSV.html">ResultsPane/widgets/ExportCSV</a></li><li><a href="module-ResultsPane_widgets_ExportCrashRecords.html">ResultsPane/widgets/ExportCrashRecords</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_ExportCrashRecords.html#~enableSpinner">enableSpinner</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_ExportCrashRecords.html#~exportRecords">exportRecords</a></li></ul></li><li><a href="module-ResultsPane_widgets_FilterSummary.html">ResultsPane/widgets/FilterSummary</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_FilterSummary.html#~formatYearFilter">formatYearFilter</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_FilterSummary.html#~removeLabels">removeLabels</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_FilterSummary.html#~update">update</a></li></ul></li><li><a href="module-ResultsPane_widgets_ResultsGrid.html">ResultsPane/widgets/ResultsGrid</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_ResultsGrid.html#~compare_cty_code">compare_cty_code</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_ResultsGrid.html#~compare_muni_code">compare_muni_code</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_ResultsGrid.html#~exportCsv">exportCsv</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_ResultsGrid.html#~hide">hide</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_ResultsGrid.html#~removeDuplicateObjects">removeDuplicateObjects</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_ResultsGrid.html#~removeHighlight">removeHighlight</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_ResultsGrid.html#~resize">resize</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_ResultsGrid.html#~show">show</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_ResultsGrid.html#~update">update</a></li></ul></li><li><a href="module-SettingsMenu.html">SettingsMenu</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-SettingsMenu.html#~disableClusterToggleButton">disableClusterToggleButton</a></li><li data-type='method' style='display: none;'><a href="module-SettingsMenu.html#~hide">hide</a></li><li data-type='method' style='display: none;'><a href="module-SettingsMenu.html#~show">show</a></li><li data-type='method' style='display: none;'><a href="module-SettingsMenu.html#~startTour">startTour</a></li></ul></li><li><a href="module-SettingsMenu_widgets_BasemapToggle.html">SettingsMenu/widgets/BasemapToggle</a></li><li><a href="module-SettingsMenu_widgets_ClusterToggle.html">SettingsMenu/widgets/ClusterToggle</a></li><li><a href="module-SettingsMenu_widgets_CrashClusterSelect.html">SettingsMenu/widgets/CrashClusterSelect</a></li><li><a href="module-SettingsMenu_widgets_MenuAnnotationToggle.html">SettingsMenu/widgets/MenuAnnotationToggle</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-SettingsMenu_widgets_MenuAnnotationToggle.html#~setAnnotationMode">setAnnotationMode</a></li></ul></li><li><a href="module-SettingsMenu_widgets_SignalsTourToggle_widgets_WelcomeTour.html">SettingsMenu/widgets/SignalsTourToggle/widgets/WelcomeTour</a></li><li><a href="module-SettingsMenu_widgets_TourToggle.html">SettingsMenu/widgets/TourToggle</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-SettingsMenu_widgets_TourToggle.html#~mouseEnterHandler">mouseEnterHandler</a></li><li data-type='method' style='display: none;'><a href="module-SettingsMenu_widgets_TourToggle.html#~mouseLeaveHandler">mouseLeaveHandler</a></li></ul></li><li><a href="module-SettingsMenu_widgets_UserManual.html">SettingsMenu/widgets/UserManual</a></li><li><a href="module-StatsExplorer.html">StatsExplorer</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~clear">clear</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~clearChart">clearChart</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~clearVehicleChartDivs">clearVehicleChartDivs</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~createChart">createChart</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~createPersonsSeverityChart">createPersonsSeverityChart</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~createSelect">createSelect</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~createVehicleModelChart">createVehicleModelChart</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~createVehiclesAttributeChart">createVehiclesAttributeChart</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~generateVehicleChartDivs">generateVehicleChartDivs</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~init">init</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~loading">loading</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~loadingDiv">loadingDiv</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~update">update</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~updateSeverityChart">updateSeverityChart</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~updateStatsChart">updateStatsChart</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~updateVehicleMakeChart">updateVehicleMakeChart</a></li></ul></li><li><a href="module-StatsPane.html">StatsPane</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-StatsPane.html#~checkOpen">checkOpen</a></li><li data-type='method' style='display: none;'><a href="module-StatsPane.html#~init">init</a></li><li data-type='method' style='display: none;'><a href="module-StatsPane.html#~togglePane">togglePane</a></li><li data-type='method' style='display: none;'><a href="module-StatsPane.html#~update">update</a></li></ul></li><li><a href="module-Utilities.html">Utilities</a></li><li><a href="module-urls.html">urls</a></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">ResultsPane/widgets/ResultsGrid/index.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { Grid } from 'ag-grid-community';
import mapboxgl from 'mapbox-gl';
import union from '@turf/union';
import center from '@turf/center';
import { feature, polygon } from '@turf/turf';
import CrashGrouping from '../../../CrashMap/widgets/CrashGrouping';
import Modal from '../../../Modal';

import './../../../../../node_modules/ag-grid-community/styles/ag-grid.css';
import './../../../../../node_modules/ag-grid-community/styles/ag-theme-alpine.css';

/**
 * Creates the div containing the results grid which displays the features in the map in a tabular format.
 * Handles click events when a user clicks on a row bu highlighting the feature on the map and zooming to it. 
 * @date 2024-11-20
 * @module ResultsPane/widgets/ResultsGrid
 * @param {module} resultsPane The Results Pane module.
 * @param {module} crashMap The Crash Map module.
 * @param {module} crashFilter The Crash Filter module.
 * @requires ag-grid-community
 * @requires mapbox-gl
 * @requires @turf/union
 * @requires @turf/center
 * @requires @turf/turf
 * @requires ../../../CrashMap/widgets/CrashGrouping
 * @requires ../../../Modal
 * @requires ../../../../../node_modules/ag-grid-community/styles/ag-grid.css
 * @requires ../../../../../node_modules/ag-grid-community/styles/ag-theme-alpine.css
 */
export default function ResultsGrid(resultsPane, crashMap, crashFilter) {
    const self = this;

    const tabulatedResultsGrid = document.createElement('div');
    tabulatedResultsGrid.className = 'tabulated-results-grid ag-theme-alpine';
    tabulatedResultsGrid.id = 'tabulated-results-grid';

    this.features = [];

    /**
     * @name gridOptions
     * @static
     * The default options for the results grid formatted for the `ag-grid` framework.
     */
    this.gridOptions = {
        columnDefs: [],
        rowData: [],
        onCellMouseOver: highlightFeature,
        onCellMouseOut: removeHighlight,
        onCellClicked: zoomToFeature,
        suppressCellFocus: true,
        defaultColDef: {
            sortable: true,
            wrapHeaderText: true,
            autoHeaderHeight: true,
            resizeable: true,
        },
        autoSizeStrategy: {
            type: 'fitGridWidth',
            defaultMinWidth: 100,
        },
        onGridReady: (params) => {
            params.api.showLoadingOverlay();
        },
    };

    this.grid = new Grid(tabulatedResultsGrid, self.gridOptions);

    /**
     * Updates the results grid with new data `features`.
     * @date 2024-11-20
     * @function update
     * @param {object[]} features An array of feature objects to update the results grid with.
     */
    this.update = function (features) {
        self.features = features;
        const gridData = processFeatures(features);
        this.gridOptions.api.setColumnDefs(gridData.columns);
        this.gridOptions.api.setRowData(gridData.data);
        if (resultsPane.isOpen()) {
            self.resize();
        }
    };

    /**
     * Resizes the columns of the grid to fit the available space.
     *
     * @function resize
     * @date 2024-11-20
     */
    this.resize = function () {
        self.gridOptions.api.sizeColumnsToFit();
    };

    /**
     * Exports the grid data as a CSV file named 'signals_grid_export.csv'.
     *
     * @function exportCsv
     * @date 2024-11-20
     */
    this.exportCsv = function () {
        self.gridOptions.api.exportDataAsCsv({
            fileName: 'voyager_grid_export.csv',
        });
    };

    /**
     * Displays the grid by removing the 'hidden' class from the `tabulatedResultsGrid` element.
     *
     * @function show
     * @date 2024-11-20
     */
    this.show = function () {
        tabulatedResultsGrid.classList.remove('hidden');
    };

    /**
     * Hides the grid by adding the 'hidden' class to the `tabulatedResultsGrid` element.
     *
     * @function hide
     * @date 2024-11-20
     */
    this.hide = function () {
        tabulatedResultsGrid.classList.add('hidden');
    };

    /**
     * Provides the column and data structure for the results grid.
     * @date 2022-02-08
     * @param {array} features - array of features from the map using the queryRenderedFeatures function.
     * @returns {object} { column: column_structure, data: grid_data }
     */
    function processFeatures(features) {
        const selectedJurisdictions = crashFilter.getSelectedJurisdictions();
        const uniqueFeatures = removeDuplicateObjects(features);
        // console.log(uniqueFeatures);
        const properties = uniqueFeatures.map((feature) => feature.properties);
        var featureSource = uniqueFeatures[0].source;
        var columns = [];
        var dataArray = [];

        if (uniqueFeatures.length > 0) {
            if (featureSource === 'county_heatmap') {
                columns = [
                    {
                        field: 'county_label',
                        headerName: 'County',
                        sortable: true,
                        filter: true,
                        resizeable: true,
                        unSortIcon: true,
                    },
                    {
                        field: 'crash_count',
                        headerName: 'Crash Count',
                        sortable: true,
                        valueFormatter: function (params) {
                            if (params.value) {
                                return `${params.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')}`;
                            }
                        },
                        resizeable: true,
                        unSortIcon: true,
                    },
                    {
                        field: 'fatal',
                        headerName: 'Fatal',
                        sortable: true,
                        valueFormatter: function (params) {
                            if (params.value) {
                                return `${params.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')}`;
                            }
                        },
                        resizeable: true,
                        unSortIcon: true,
                    },
                    {
                        field: 'incapacitated',
                        headerName: 'Incapacitated',
                        sortable: true,
                        valueFormatter: function (params) {
                            if (params.value) {
                                return `${params.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')}`;
                            }
                        },
                        resizeable: true,
                        unSortIcon: true,
                    },
                    {
                        field: 'moderate_injury',
                        headerName: 'Moderate Injury',
                        sortable: true,
                        valueFormatter: function (params) {
                            if (params.value) {
                                return `${params.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')}`;
                            }
                        },
                        resizeable: true,
                        unSortIcon: true,
                    },
                    {
                        field: 'complaint_of_pain',
                        headerName: 'Complaint of Pain',
                        sortable: true,
                        valueFormatter: function (params) {
                            if (params.value) {
                                return `${params.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')}`;
                            }
                        },
                        resizeable: true,
                        unSortIcon: true,
                    },
                    {
                        field: 'property_damage',
                        headerName: 'Property Damage',
                        sortable: true,
                        valueFormatter: function (params) {
                            if (params.value) {
                                return `${params.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')}`;
                            }
                        },
                        resizeable: true,
                        unSortIcon: true,
                    },
                ];
                uniqueFeatures.forEach((feature) => {
                    var featureProperties = feature.properties;
                    featureProperties['id'] = feature.id;

                    if (selectedJurisdictions.codes.length === 0 || selectedJurisdictions.codes.includes(feature.properties.mun_cty_co)) {
                        dataArray.push(featureProperties);
                    }
                });
                dataArray.sort(compare_cty_code);
                dataArray = dataArray.filter((v, i, a) => a.findIndex((t) => t.county_label === v.county_label) === i); // TEMP - remove duplicates
            } else if (featureSource === 'muni_heatmap') {
                // this is muni level
                columns = [
                    {
                        field: 'county',
                        headerName: 'County',
                        sortable: true,
                        filter: true,
                        resizeable: true,
                        unSortIcon: true,
                    },
                    {
                        field: 'mun_label',
                        headerName: 'Municipality',
                        sortable: true,
                        filter: true,
                        resizeable: true,
                        unSortIcon: true,
                    },
                    {
                        field: 'crash_count',
                        headerName: 'Crash Count',
                        sortable: true,
                        valueFormatter: function (params) {
                            if (params.value) {
                                return `${params.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')}`;
                            }
                        },
                    },
                    {
                        field: 'fatal',
                        headerName: 'Fatal',
                        sortable: true,
                        valueFormatter: function (params) {
                            if (params.value) {
                                return `${params.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')}`;
                            }
                        },
                        resizeable: true,
                        unSortIcon: true,
                    },
                    {
                        field: 'incapacitated',
                        headerName: 'Incapacitated',
                        sortable: true,
                        valueFormatter: function (params) {
                            if (params.value) {
                                return `${params.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')}`;
                            }
                        },
                        resizeable: true,
                        unSortIcon: true,
                    },
                    {
                        field: 'moderate_injury',
                        headerName: 'Moderate Injury',
                        sortable: true,
                        valueFormatter: function (params) {
                            if (params.value) {
                                return `${params.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')}`;
                            }
                        },
                        resizeable: true,
                        unSortIcon: true,
                    },
                    {
                        field: 'complaint_of_pain',
                        headerName: 'Complaint of Pain',
                        sortable: true,
                        valueFormatter: function (params) {
                            if (params.value) {
                                return `${params.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')}`;
                            }
                        },
                        resizeable: true,
                        unSortIcon: true,
                    },
                    {
                        field: 'property_damage',
                        headerName: 'Property Damage',
                        sortable: true,
                        valueFormatter: function (params) {
                            if (params.value) {
                                return `${params.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')}`;
                            }
                        },
                        resizeable: true,
                        unSortIcon: true,
                    },
                ];
                uniqueFeatures.forEach((feature) => {
                    var featureProperties = feature.properties;
                    featureProperties['id'] = feature.id;

                    if (
                        selectedJurisdictions.codes.length === 0 ||
                        selectedJurisdictions.codes.includes(feature.properties.mun_cty_co + feature.properties.mun_mu) ||
                        selectedJurisdictions.codes.includes(feature.properties.mun_cty_co)
                    ) {
                        dataArray.push(featureProperties);
                    }

                    // data = feature.properties;
                    // data['id'] = feature.id;
                });
                dataArray.sort(compare_muni_code);
                dataArray = dataArray.filter((v, i, a) => a.findIndex((t) => t.mun_label === v.mun_label) === i); // TEMP - remove duplicates
            } else if (uniqueFeatures[0].properties.hasOwnProperty('sri')) {
                // this is an SRI
                columns = [
                    {
                        field: 'sri',
                        headerName: 'SRI',
                        resizable: true,
                        minWidth: 125,
                    },
                    {
                        field: 'milepost_range_text',
                        headerName: 'Milepost Range (Inclusive)',
                        sortable: true,
                        formatter: (params) => `${params.value !== null ? `${params.value.toFixed(2)}` : ''} `,
                        resizable: true,
                        minWidth: 200,
                        width: 200,
                    },
                    {
                        field: 'crash_count',
                        headerName: 'Crash Count',
                        sortable: true,
                        // sort: [`${featureSource === 'crash_segments_source' ? 'desc' : 'null'}`],
                        resizable: true,
                        valueFormatter: function (params) {
                            if (params.value) {
                                return `${params.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')}`;
                            }
                        },
                    },
                    {
                        field: 'fatal',
                        headerName: 'Fatal',
                        sortable: true,
                        valueFormatter: function (params) {
                            if (params.value) {
                                return `${params.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')}`;
                            }
                        },
                        resizeable: true,
                        minWidth: 75,
                    },
                    {
                        field: 'incapacitated',
                        headerName: 'Incapacitated',
                        sortable: true,
                        valueFormatter: function (params) {
                            if (params.value) {
                                return `${params.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')}`;
                            }
                        },
                        resizeable: true,
                    },
                    {
                        field: 'moderate_injury',
                        headerName: 'Moderate Injury',
                        sortable: true,
                        valueFormatter: function (params) {
                            if (params.value) {
                                return `${params.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')}`;
                            }
                        },
                        resizeable: true,
                    },
                    {
                        field: 'complaint_of_pain',
                        headerName: 'Complaint of Pain',
                        sortable: true,
                        valueFormatter: function (params) {
                            if (params.value) {
                                return `${params.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')}`;
                            }
                        },
                        resizeable: true,
                    },
                    {
                        field: 'property_damage',
                        headerName: 'Property Damage',
                        sortable: true,
                        valueFormatter: function (params) {
                            if (params.value) {
                                return `${params.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')}`;
                            }
                        },
                        resizeable: true,
                    },
                ];
                dataArray = properties;
            } else {
                const clusterSize = function (zoomLevel) {
                    const earthCircumference = 40075017;
                    const latitudeRadians = 40.0583 * (Math.PI / 180);
                    const meterValue = (earthCircumference * Math.cos(latitudeRadians)) / Math.pow(2, zoomLevel + 9);
                    const clusterSize = meterValue * 15 * 2 * 3.28084;
                    const order = Math.floor(Math.log(clusterSize) / Math.LN10 + 0.000000001); // because float math sucks like that

                    return Math.round(clusterSize / Math.pow(10, order)) * Math.pow(10, order);
                };

                // cluster view
                uniqueFeatures.sort((a, b) => (a.properties.crash_count > b.properties.crash_count ? -1 : 1));
                uniqueFeatures.forEach((feature, index) => {
                    var clusterData = {};
                    clusterData = feature.properties;
                    clusterData['cluster_num'] = `${clusterSize(crashMap.map.getZoom())} - Foot Cluster`;
                    clusterData['id'] = feature.id;
                    dataArray.push(clusterData);
                });

                columns = [
                    {
                        field: 'cluster_num',
                        headerName: 'Cluster',
                    },
                    {
                        field: 'crash_count',
                        headerName: 'Crash Count',
                        sortable: true,
                        valueFormatter: function (params) {
                            if (params.value) {
                                return `${params.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')}`;
                            }
                        },
                    },
                    {
                        field: 'fatal',
                        headerName: 'Fatal',
                        sortable: true,
                        valueFormatter: function (params) {
                            if (params.value) {
                                return `${params.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')}`;
                            }
                        },
                        resizeable: true,
                        unSortIcon: true,
                    },
                    {
                        field: 'incapacitated',
                        headerName: 'Incapacitated',
                        sortable: true,
                        valueFormatter: function (params) {
                            if (params.value) {
                                return `${params.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')}`;
                            }
                        },
                        resizeable: true,
                        unSortIcon: true,
                    },
                    {
                        field: 'moderate_injury',
                        headerName: 'Moderate Injury',
                        sortable: true,
                        valueFormatter: function (params) {
                            if (params.value) {
                                return `${params.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')}`;
                            }
                        },
                        resizeable: true,
                        unSortIcon: true,
                    },
                    {
                        field: 'complaint_of_pain',
                        headerName: 'Complaint of Pain',
                        sortable: true,
                        valueFormatter: function (params) {
                            if (params.value) {
                                return `${params.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')}`;
                            }
                        },
                        resizeable: true,
                        unSortIcon: true,
                    },
                    {
                        field: 'property_damage',
                        headerName: 'Property Damage',
                        sortable: true,
                        valueFormatter: function (params) {
                            if (params.value) {
                                return `${params.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')}`;
                            }
                        },
                        resizeable: true,
                        unSortIcon: true,
                    },
                ];
            }
        }

        return { columns: columns, data: dataArray };
    }

    /**
     * Removes duplicate objects from an array based on the `properties` attribute.
     * Compares objects by their `properties` stringified version to detect duplicates.
     * @function removeDuplicateObjects
     * @param {object[]} array - The array of objects to filter.
     * @returns {object[]} A new array with duplicate objects removed.
     * @date 2024-11-22
     * @example
     * const array = [
     *   { properties: { id: 1, name: 'A' } },
     *   { properties: { id: 1, name: 'A' } },
     *   { properties: { id: 2, name: 'B' } }
     * ];
     * const uniqueArray = removeDuplicateObjects(array);
     * console.log(uniqueArray); // Output: [ { properties: { id: 1, name: 'A' } }, { properties: { id: 2, name: 'B' } }]
     */
    function removeDuplicateObjects(array) {
        const seen = [];

        return array.filter((item) => {
            if (item.properties &amp;&amp; typeof item.properties === 'object') {
                const propertiesString = JSON.stringify(item.properties);
                if (seen.includes(propertiesString)) {
                    return false;
                } else {
                    seen.push(propertiesString);
                    return true;
                }
            }
            return true;
        });
    }

    function codeToDirection(codes) {
        const legend = {
            '01': 'North',
            '02': 'East',
            '03': 'South',
            '04': 'West',
        };

        return codes
            .split(',')
            .map((code) => legend[code.trim()])
            .join(', ');
    }

    /**
     * Compares two objects based on their `mun_cty_co` value, which is assumed to be a number.
     * @function compare_cty_code
     * @param {Object} a - The first object to compare.
     * @param {Object} b - The second object to compare.
     * @returns {number} -1 if `a.mun_cty_co` is less than `b.mun_cty_co`, 1 if greater, 0 if equal.
     * @date 2024-11-22
     * @example
     * const a = { mun_cty_co: '102' };
     * const b = { mun_cty_co: '200' };
     * console.log(compare_cty_code(a, b)); // Output: -1
     */
    function compare_cty_code(a, b) {
        if (parseInt(a.mun_cty_co) &lt; parseInt(b.mun_cty_co)) {
            return -1;
        }
        if (parseInt(a.mun_cty_co) > parseInt(b.mun_cty_co)) {
            return 1;
        }
        return 0;
    }

    /**
     * Compares two objects based on both their `mun_cty_co` and `mun_mu` values.
     * First compares `mun_cty_co`, then compares `mun_mu` if `mun_cty_co` is equal.
     * @function compare_muni_code
     * @param {Object} a - The first object to compare.
     * @param {Object} b - The second object to compare.
     * @returns {number} -1 if `a` is less than `b`, 1 if greater, 0 if equal.
     * @date 2024-11-22
     * @example
     * const a = { mun_cty_co: '102', mun_mu: '10' };
     * const b = { mun_cty_co: '102', mun_mu: '20' };
     * console.log(compare_muni_code(a, b)); // Output: -1
     */
    function compare_muni_code(a, b) {
        if (parseInt(a.mun_cty_co) &lt; parseInt(b.mun_cty_co)) {
            return -1;
        }
        if (parseInt(a.mun_cty_co) > parseInt(b.mun_cty_co)) {
            return 1;
        }
        if (parseInt(a.mun_mu) &lt; parseInt(b.mun_mu)) {
            return -1;
        }
        if (parseInt(a.mun_mu) > parseInt(b.mun_mu)) {
            return 1;
        }
        return 0;
    }

    /**
     * Highlights a feature based on the target hover item in the results table.
     * @date 2022-02-14
     * @param {object} event - mouseover event object from ag-grid
     * @returns None. Adds a geometry shape to the map using CrashMap/widgets/HighlightFeature
     */
    function highlightFeature(event) {
        if (event.data) {
            if (event.data.hasOwnProperty('segment_id')) {
                crashMap.map.crashSegmentsHeatmap.highlightFeature(event.data);
            } else {
                const geomObject = getFeatureGeom(event.data);
                if (geomObject) crashMap.map.highlightFeature.update(geomObject);
            }
        }
    }

    /**
     * Gets the feature's geomotry based on a unique attribute (county code, municipal code, cluster id)
     * @date 2022-02-17
     * @param {object} featureData - the feature's properties queried directly from the map. Can be county, municipal, or cluster properties.
     * @returns {object} the feature's geometry. Polygon for county/muni; point for clusters
     */
    function getFeatureGeom(featureData) {
        if (!featureData.hasOwnProperty('id')) return undefined; // TEMP FOR SRI HIGHLIGHTING
        const layerData = getFeatureLayerData(featureData.id);

        // don't use queryRenderedFeatures on the cluster layer as the layer can't be filtered by a unique id.
        // instead, find the cluster id from self.features to get the geometry
        if (layerData.id === 'cluster_circles') {
            for (let index = 0; index &lt; self.features.length; index++) {
                if (self.features[index].id === featureData.id) {
                    // console.log(self.features[index].geometry);
                    return self.features[index].geometry;
                }
            }
        }

        // query geometry for county or municipal heatmap layer
        const renderedFeatureParam = getRenderedFeaturesParams(featureData, layerData.id);
        const feature = crashMap.map.queryRenderedFeatures(renderedFeatureParam);
        // console.log(feature);

        var coordsArray = [];
        var geomObject = {};

        if (feature.length === 0) return undefined;
        if (feature.length == 1) {
            geomObject['coordinates'] = feature[0].geometry.coordinates;
            geomObject['type'] = feature[0].geometry.type;
            return geomObject;
        } else if (feature.length > 1) {
            // need to union all the broken geometries together
            for (let index = 0; index &lt; feature.length; index++) {
                const coords = feature[index].geometry.coordinates;

                // if it's the first set of coordinates, set this as the primary array of coords. All other sets will be added to this one.
                if (index == 0) {
                    geomObject['type'] = feature[index].geometry.type;
                    if (coords.length > 1) {
                        coordsArray = unionGeometry(coords);
                    } else {
                        coordsArray = polygon(coords);
                    }
                } else {
                    if (coords.length > 1) {
                        const unionGeom = unionGeometry(coords);
                        coordsArray = union(coordsArray, unionGeom);
                    } else {
                        coordsArray = union(coordsArray, polygon(coords));
                    }
                }
            }
            return coordsArray.geometry;
        }
    }

    /**
     * Generates the parameters for the queryRenderedFeatures function
     * @date 2022-02-17
     * @param {object} featureData - the feature's properties
     * @param {string}  layer - the layer name of the feature
     * @returns {object} a set of parameters for the queryRenderedFeatures function
     */
    function getRenderedFeaturesParams(featureData, layer) {
        if (layer === 'county_heatmap_layer') {
            return {
                layers: ['county_heatmap_layer'],
                filter: ['==', 'mun_cty_co', featureData.mun_cty_co],
            };
        } else if (layer === 'municipal_heatmap_layer') {
            return {
                layers: ['municipal_heatmap_layer'],
                filter: ['all', ['==', 'mun_cty_co', featureData.mun_cty_co], ['==', 'mun_mu', featureData.mun_mu]],
            };
        } else return undefined;
    }

    function unionGeometry(coordinatesArray) {
        if (coordinatesArray.length === 0) return undefined;
        if (coordinatesArray.length === 1) return polygon(coordinatesArray[0]);
        else {
            var unionCoords = [];
            for (let index = 0; index &lt; coordinatesArray.length; index++) {
                const coordsSet = coordinatesArray[index];
                if (index === 0) {
                    unionCoords = polygon(coordsSet);
                } else {
                    unionCoords = union(unionCoords, polygon(coordsSet));
                }
            }
            return unionCoords;
        }
    }

    /**
     * Gets the Feature's layer data based on it's ID number
     * @date 2022-02-17
     * @param {number} featureId - id of the target Feature
     * @returns {object} - Feature's layer object {  id: "county_heatmap_layer", source: "...", ... }
     */
    function getFeatureLayerData(featureId) {
        for (let index = 0; index &lt; self.features.length; index++) {
            const feature = self.features[index];
            if (feature.id === featureId) return feature.layer;
        }
    }

    /**
     * Gets the Feature's properties data based on it's ID number.
     * @date 2022-02-17
     * @param {number} featureId - id of the target Feature
     * @returns {object} - Feature's properties object {  properties: {signalId: ..., lat: ..., long: ..., ...} }
     */
    function getFeatureProperties(featureId) {
        for (let index = 0; index &lt; self.features.length; index++) {
            const feature = self.features[index];
            if (feature.id === featureId) return feature.properties;
        }
    }

    /**
     * Removes the highlight from a feature based on the event data. If the data contains 
     * 'rounded_mp_text', it removes the highlight from the `sriHistogram`; otherwise, 
     * it clears the highlight from the feature.
     *
     * @function removeHighlight
     * @date 2024-11-20
     * @param {Event} event - The event object containing the data to check for highlighting.
     */
    function removeHighlight(event) {
        if (event.data) {
            if (event.data.hasOwnProperty('milepost_range_text') &amp;&amp; !event.data.hasOwnProperty('segment_id')) {
                if (crashMap.map.hasOwnProperty('sriHistogram')) crashMap.map.sriHistogram.removeHighlight();
            }
            crashMap.map.highlightFeature.clearHighlight();
        }
    }

    /**
     * Zooms to a feature in the map.
     * @date 2024-11-22
     * @param {function} event The event handler from the results grid.
     */
    function zoomToFeature(event) {
        const tableRow = event.data;
        if (event.data.id) {
            const propertiesObject = getFeatureProperties(event.data.id);
            if (propertiesObject) {
                if (propertiesObject.hasOwnProperty('bounding_box')) {
                    const options = {
                        padding: 100,
                        pitch: 0,
                    };
                    const bb = JSON.parse(propertiesObject['bounding_box']);
                    const bounds = new mapboxgl.LngLatBounds(bb[0], bb[1]);
                    const newCameraTransform = crashMap.map.cameraForBounds(bounds, options);
                    crashMap.map.jumpTo(newCameraTransform);
                    crashMap.map.fitBounds(bounds, options);
                } else {
                    const geomObject = getFeatureGeom(event.data);
                    if (geomObject['type'] === 'Point') {
                        const coords = geomObject['coordinates'];
                        const lngLat = [coords[0], coords[1]];
                        crashMap.map.flyTo({
                            center: lngLat,
                            // zoom: 15,
                            pitch: 0,
                            essential: true, // this animation is considered essential with respect to prefers-reduced-motion
                        });
                    }
                }
            }
        } else if (event.data.hasOwnProperty('segment_id')) {
            const selectedFeature = crashMap.map.queryRenderedFeatures({
                layers: ['crash_segments'],
                filter: [
                    'all',
                    ['==', 'segment_id', tableRow.segment_id],
                    ['==', 'crash_count', tableRow.crash_count],
                    ['==', 'sri', tableRow.sri],
                    ['==', 'milepost_range_text', tableRow.milepost_range_text],
                    ['==', 'segment_directions', tableRow.segment_directions],
                ],
            });
            if (selectedFeature.length > 0) {
                const geom = selectedFeature[0].geometry;
                var bounds = new mapboxgl.LngLatBounds();

                geom.coordinates.forEach(function (coord) {
                    bounds.extend(coord);
                });
                crashMap.map.panTo(bounds.getCenter(), { padding: 100 });
                const additionalFilters = {
                    sri: selectedFeature[0].properties.sri,
                    mp_start: selectedFeature[0].properties.min_mp,
                    mp_end: selectedFeature[0].properties.max_mp,
                    veh_one_travel_dir_code: selectedFeature[0].properties.segment_directions,
                };
                new CrashGrouping(crashFilter, undefined, undefined, crashMap, additionalFilters, selectedFeature[0]);
                crashMap.StatsPane.update(additionalFilters);
            }
        }
        else if (event.data.rounded_mp !== null) {
            // SRI data -> show Crash Grouping dialog
            const features = crashMap.map.queryRenderedFeatures({
                layers: ['route_histogram_layer'],
                filter: ['in', 'mp', event.data.rounded_mp],
            });
            if (features.length > 0) {
                var bounds = new mapboxgl.LngLatBounds();

                features.forEach(function (feature) {
                    bounds.extend(feature.geometry.coordinates[0]);
                });

                new CrashGrouping(crashFilter, JSON.parse(features[0].properties.crash_array), undefined, crashMap);
            } else {
                // query the SRI Histogram layer to get milepost geom data
                const sriGeomLFeatures = crashMap.map.querySourceFeatures('route_histogram_source', {
                    sourceLayer: 'segment_polygon',
                    filter: ['in', 'mp', event.data.rounded_mp],
                });
                // console.log(sriGeomLFeatures);
                // pan to the milepost geom so queryRenderedFeatures function can get the features
                if (sriGeomLFeatures.length > 0) {
                    const geomFeature = sriGeomLFeatures[0];
                    const centroid = center(geomFeature);

                    if (centroid.hasOwnProperty('geometry')) {
                        crashMap.map.panTo(centroid.geometry.coordinates);
                    }

                    crashMap.map.once('moveend', () => {
                        const features = crashMap.map.queryRenderedFeatures({
                            layers: ['route_histogram_layer'],
                            filter: ['in', 'mp', event.data.rounded_mp],
                        });

                        if (features.length > 0) {
                            var bounds = new mapboxgl.LngLatBounds();

                            features.forEach(function (feature) {
                                bounds.extend(feature.geometry.coordinates[0]);
                            });

                            new CrashGrouping(crashFilter, JSON.parse(features[0].properties.crash_array), undefined, crashMap);
                        } else {
                            new Modal({
                                title: 'No Crash Records Found',
                                content: 'Please pan your map view to the milepost bar on the SRI route to display crash records.',
                                buttonText: 'Continue',
                            }).show();
                        }
                    });
                } else {
                    new Modal({
                        title: 'No Crash Records Found',
                        content: 'Please pan your map view to the milepost bar on the SRI route to display crash records.',
                    }).show();
                }
            }
        } else if (event.data.rounded_mp == null) {
            // this is  unmatched municipality data
            const features = crashMap.map.queryRenderedFeatures({
                layers: ['route_unmatched_layer'],
                filter: ['all', ['in', 'mun_cty_co', event.data.mun_cty_co], ['in', 'mun_mu', event.data.mun_mu]],
            });
            if (features.length > 0) {
                new CrashGrouping(crashFilter, JSON.parse(features[0].properties.crash_array), undefined, crashMap);
            }
        } else {
            new Modal({
                title: 'No Crash Records Found',
                content: 'Please pan your map view to the milepost bar on the SRI route to display crash records.',
            }).show();
        }
        self.gridOptions.api.setFilterModel(null);
    }

    this.domNode = tabulatedResultsGrid;
}
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.4</a> on Tue Dec 17 2024 10:18:34 GMT-0500 (Eastern Standard Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>


<script src="scripts/collapse.js" defer></script>


</body>
</html>
