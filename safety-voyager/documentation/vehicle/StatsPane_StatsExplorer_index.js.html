<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>StatsPane/StatsExplorer/index.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    
    <h2><a href="index.html">Home</a></h2><h2><a href="https://github.com/Greenman-Pedersen-Inc/voyager.webpack.vehicle" target="_blank" class="menu-item" id="repo_link" >Github Repository</a></h2><h3>Modules</h3><ul><li><a href="module-API.html">API</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-API.html#.getCrashSegmentsHeatmapQuery">getCrashSegmentsHeatmapQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#.getNetworkSegmentData">getNetworkSegmentData</a></li><li data-type='method' style='display: none;'><a href="module-API.html#.getStateBreakdown">getStateBreakdown</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~CreateDetailWhereClause">CreateDetailWhereClause</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~CreateSearchParameters">CreateSearchParameters</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~CreateWhereClause">CreateWhereClause</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~GetAccidentsBySriQuery">GetAccidentsBySriQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~GetClusterHeatmapQuery">GetClusterHeatmapQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~GetCountyHeatmapQuery">GetCountyHeatmapQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~GetCrashDetailsQuery">GetCrashDetailsQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~GetCrashesQuery">GetCrashesQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~GetMuniHeatmapQuery">GetMuniHeatmapQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~GetPersonsQuery">GetPersonsQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~GetSriQuery">GetSriQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~addUserQueries">addUserQueries</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~deleteUserQueries">deleteUserQueries</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~errorHandler">errorHandler</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getCountyBoundaries">getCountyBoundaries</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getCountyBoundingBoxQuery">getCountyBoundingBoxQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getCrash">getCrash</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getCrashDetailQuery">getCrashDetailQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getCrashList">getCrashList</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getData">getData</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getExportRecords">getExportRecords</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getExportRecordsByID">getExportRecordsByID</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getFeedbackFormQuery">getFeedbackFormQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getFullName">getFullName</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getGraphDataQuery">getGraphDataQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getLayerAttributes">getLayerAttributes</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getMPO">getMPO</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getModules">getModules</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getMunicipalBoundingBoxQuery">getMunicipalBoundingBoxQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getMunicipalityBoundaries">getMunicipalityBoundaries</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getNotifications">getNotifications</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getRouteCrashData">getRouteCrashData</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getSRIBreakdown">getSRIBreakdown</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getSRIHistogramQuery">getSRIHistogramQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getSRIUnderlayQuery">getSRIUnderlayQuery</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getSessionInfo">getSessionInfo</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getTable">getTable</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getTopLocations">getTopLocations</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~getUserQueries">getUserQueries</a></li><li data-type='method' style='display: none;'><a href="module-API.html#~postData">postData</a></li></ul></li><li><a href="module-AlertBox.html">AlertBox</a></li><li><a href="module-CodeTranslator.html">CodeTranslator</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-CodeTranslator.html#~convertCodeDescription">convertCodeDescription</a></li><li data-type='method' style='display: none;'><a href="module-CodeTranslator.html#~convertFeature">convertFeature</a></li><li data-type='method' style='display: none;'><a href="module-CodeTranslator.html#~convertFeatureObjectValues">convertFeatureObjectValues</a></li><li data-type='method' style='display: none;'><a href="module-CodeTranslator.html#~convertTableCodes">convertTableCodes</a></li><li data-type='method' style='display: none;'><a href="module-CodeTranslator.html#~resolveFieldAlias">resolveFieldAlias</a></li></ul></li><li><a href="module-CrashFilter.html">CrashFilter</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-CrashFilter.html#~clearSearchHighlights">clearSearchHighlights</a></li><li data-type='method' style='display: none;'><a href="module-CrashFilter.html#~getSelectedFilters">getSelectedFilters</a></li><li data-type='method' style='display: none;'><a href="module-CrashFilter.html#~getSelectedJurisdictions">getSelectedJurisdictions</a></li><li data-type='method' style='display: none;'><a href="module-CrashFilter.html#~getSignalsSelectedFilters">getSignalsSelectedFilters</a></li><li data-type='method' style='display: none;'><a href="module-CrashFilter.html#~reset">reset</a></li><li data-type='method' style='display: none;'><a href="module-CrashFilter.html#~searchFilters">searchFilters</a></li><li data-type='method' style='display: none;'><a href="module-CrashFilter.html#~setFilters">setFilters</a></li></ul></li><li><a href="module-CrashMap_widgets_CrashClusters.html">CrashMap/widgets/CrashClusters</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_CrashClusters.html#~addToMap">addToMap</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_CrashClusters.html#~setMinZoom">setMinZoom</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_CrashClusters.html#~update">update</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_CrashClusters.html#~updateSourceData">updateSourceData</a></li></ul></li><li><a href="module-CrashMap_widgets_CrashGrouping.html">CrashMap/widgets/CrashGrouping</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_CrashGrouping.html#~CrashGrouping">CrashGrouping</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_CrashGrouping.html#~addSelectValues">addSelectValues</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_CrashGrouping.html#~removePriorWindows">removePriorWindows</a></li></ul></li><li><a href="module-CrashMap_widgets_CrashGrouping_widgets_BreakdownComparator.html">CrashMap/widgets/CrashGrouping/widgets/BreakdownComparator</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_CrashGrouping_widgets_BreakdownComparator.html#~update">update</a></li></ul></li><li><a href="module-CrashMap_widgets_CrashGrouping_widgets_BreakdownComparator_widgets_BreakdownChart.html">CrashMap/widgets/CrashGrouping/widgets/BreakdownComparator/widgets/BreakdownChart</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_CrashGrouping_widgets_BreakdownComparator_widgets_BreakdownChart.html#~update">update</a></li></ul></li><li><a href="module-CrashMap_widgets_CrashRecordDialog.html">CrashMap/widgets/CrashRecordDialog</a></li><li><a href="module-CrashMap_widgets_CrashSegmentsHeatmap.html">CrashMap/widgets/CrashSegmentsHeatmap</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_CrashSegmentsHeatmap.html#~addToMap">addToMap</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_CrashSegmentsHeatmap.html#~clearVisuals">clearVisuals</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_CrashSegmentsHeatmap.html#~highlightFeature">highlightFeature</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_CrashSegmentsHeatmap.html#~update">update</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_CrashSegmentsHeatmap.html#~updateSourceData">updateSourceData</a></li></ul></li><li><a href="module-CrashMap_widgets_HighlightFeature.html">CrashMap/widgets/HighlightFeature</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_HighlightFeature.html#~clearHighlight">clearHighlight</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_HighlightFeature.html#~makePointData">makePointData</a></li></ul></li><li><a href="module-CrashMap_widgets_JursidictionBoundaries.html">CrashMap/widgets/JursidictionBoundaries</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_JursidictionBoundaries.html#~addToMap">addToMap</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_JursidictionBoundaries.html#~update">update</a></li></ul></li><li><a href="module-CrashMap_widgets_Legend.html">CrashMap/widgets/Legend</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_Legend.html#~addLayerGroup">addLayerGroup</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_Legend.html#~checkXPosition">checkXPosition</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_Legend.html#~checkYPosition">checkYPosition</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_Legend.html#~clear">clear</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_Legend.html#~getPosition">getPosition</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_Legend.html#~hide">hide</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_Legend.html#~resetYPosition">resetYPosition</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_Legend.html#~show">show</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_Legend.html#~update">update</a></li></ul></li><li><a href="module-CrashMap_widgets_LegendCard.html">CrashMap/widgets/LegendCard</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_LegendCard.html#~populateCardEntries">populateCardEntries</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_LegendCard.html#~update">update</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_LegendCard.html#~updateVisibility">updateVisibility</a></li></ul></li><li><a href="module-CrashMap_widgets_LegendCardGroup.html">CrashMap/widgets/LegendCardGroup</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_LegendCardGroup.html#~createLegendScheme">createLegendScheme</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_LegendCardGroup.html#~updateVisibility">updateVisibility</a></li></ul></li><li><a href="module-CrashMap_widgets_MapSources.html">CrashMap/widgets/MapSources</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_MapSources.html#~getHighlightLayerSource">getHighlightLayerSource</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_MapSources.html#~getHighlightLayerSource">getHighlightLayerSource</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_MapSources.html#~getLayerGroupData">getLayerGroupData</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_MapSources.html#~getMapLayerData">getMapLayerData</a></li><li data-type='method' style='display: none;'><a href="module-CrashMap_widgets_MapSources.html#~getOverlayLayerDefinitions">getOverlayLayerDefinitions</a></li></ul></li><li><a href="module-CrashMap_widgets_Screenshot.html">CrashMap/widgets/Screenshot</a></li><li><a href="module-FeedbackForm.html">FeedbackForm</a></li><li><a href="module-FilterMenu.html">FilterMenu</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-FilterMenu.html#~clearCheckBoxSpinners">clearCheckBoxSpinners</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu.html#~hide">hide</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu.html#~isLoading">isLoading</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu.html#~show">show</a></li></ul></li><li><a href="module-FilterMenu_widgets_CheckboxFilter.html">FilterMenu/widgets/CheckboxFilter</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_CheckboxFilter.html#~checkFilterField">checkFilterField</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_CheckboxFilter.html#~clearTable">clearTable</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_CheckboxFilter.html#~getDescriptionSelections">getDescriptionSelections</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_CheckboxFilter.html#~getSelections">getSelections</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_CheckboxFilter.html#~reset">reset</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_CheckboxFilter.html#~selectEntireTable">selectEntireTable</a></li></ul></li><li><a href="module-FilterMenu_widgets_CheckboxFilter_widgets_CheckBoxRow.html">FilterMenu/widgets/CheckboxFilter/widgets/CheckBoxRow</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_CheckboxFilter_widgets_CheckBoxRow.html#~check">check</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_CheckboxFilter_widgets_CheckBoxRow.html#~disable">disable</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_CheckboxFilter_widgets_CheckBoxRow.html#~uncheck">uncheck</a></li></ul></li><li><a href="module-FilterMenu_widgets_DateSelector.html">FilterMenu/widgets/DateSelector</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector.html#~checkFilterField">checkFilterField</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector.html#~getDescriptionSelections">getDescriptionSelections</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector.html#~getSelections">getSelections</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector.html#~hide">hide</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector.html#~reset">reset</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector.html#~show">show</a></li></ul></li><li><a href="module-FilterMenu_widgets_DateSelector_widgets_ApplyChangesSelector.html">FilterMenu/widgets/DateSelector/widgets/ApplyChangesSelector</a></li><li><a href="module-FilterMenu_widgets_DateSelector_widgets_DateRangeSelector.html">FilterMenu/widgets/DateSelector/widgets/DateRangeSelector</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_DateRangeSelector.html#~checkFilterField">checkFilterField</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_DateRangeSelector.html#~clearDateRangeSelection">clearDateRangeSelection</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_DateRangeSelector.html#~getSelections">getSelections</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_DateRangeSelector.html#~returnRange">returnRange</a></li></ul></li><li><a href="module-FilterMenu_widgets_DateSelector_widgets_MonthSelector.html">FilterMenu/widgets/DateSelector/widgets/MonthSelector</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_MonthSelector.html#~checkFilterField">checkFilterField</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_MonthSelector.html#~clearMonthSelection">clearMonthSelection</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_MonthSelector.html#~getDescriptionSelections">getDescriptionSelections</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_MonthSelector.html#~getSelections">getSelections</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_MonthSelector.html#~highlightMonthsByValues">highlightMonthsByValues</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_MonthSelector.html#~setFilter">setFilter</a></li></ul></li><li><a href="module-FilterMenu_widgets_DateSelector_widgets_YearSelector.html">FilterMenu/widgets/DateSelector/widgets/YearSelector</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_YearSelector.html#~checkFilterField">checkFilterField</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_YearSelector.html#~clearYearSelection">clearYearSelection</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_YearSelector.html#~getDescriptionSelections">getDescriptionSelections</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_YearSelector.html#~getSelections">getSelections</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_YearSelector.html#~highlightYearsByValues">highlightYearsByValues</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_DateSelector_widgets_YearSelector.html#~setFilter">setFilter</a></li></ul></li><li><a href="module-FilterMenu_widgets_LocationFilter_widgets_ApplyChangesSelector.html">FilterMenu/widgets/LocationFilter/widgets/ApplyChangesSelector</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_LocationFilter_widgets_ApplyChangesSelector.html#~error">error</a></li></ul></li><li><a href="module-FilterMenu_widgets_LocationFilter_widgets_RadioBoxRow.html">FilterMenu/widgets/LocationFilter/widgets/RadioBoxRow</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_LocationFilter_widgets_RadioBoxRow.html#~reset">reset</a></li></ul></li><li><a href="module-FilterMenu_widgets_MultivehicleFilter.html">FilterMenu/widgets/MultivehicleFilter</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_MultivehicleFilter.html#~checkFilterField">checkFilterField</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_MultivehicleFilter.html#~getDescriptionSelections">getDescriptionSelections</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_MultivehicleFilter.html#~getSelections">getSelections</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_MultivehicleFilter.html#~hide">hide</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_MultivehicleFilter.html#~reset">reset</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_MultivehicleFilter.html#~show">show</a></li></ul></li><li><a href="module-FilterMenu_widgets_MultivehicleFilter_widgets_ApplyChangesSelector.html">FilterMenu/widgets/MultivehicleFilter/widgets/ApplyChangesSelector</a></li><li><a href="module-FilterMenu_widgets_MultivehicleFilter_widgets_SelectDropDown.html">FilterMenu/widgets/MultivehicleFilter/widgets/SelectDropDown</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_MultivehicleFilter_widgets_SelectDropDown.html#~disable">disable</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_MultivehicleFilter_widgets_SelectDropDown.html#~enable">enable</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_MultivehicleFilter_widgets_SelectDropDown.html#~reset">reset</a></li><li data-type='method' style='display: none;'><a href="module-FilterMenu_widgets_MultivehicleFilter_widgets_SelectDropDown.html#~update">update</a></li></ul></li><li><a href="module-FilterSearch.html">FilterSearch</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-FilterSearch.html#~clear">clear</a></li><li data-type='method' style='display: none;'><a href="module-FilterSearch.html#~clearSearchHighlights">clearSearchHighlights</a></li></ul></li><li><a href="module-HomeButton.html">HomeButton</a></li><li><a href="module-Modal.html">Modal</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-Modal.html#~errorHandler">errorHandler</a></li><li data-type='method' style='display: none;'><a href="module-Modal.html#~evaluateZoomVisibility">evaluateZoomVisibility</a></li><li data-type='method' style='display: none;'><a href="module-Modal.html#~remove">remove</a></li><li data-type='method' style='display: none;'><a href="module-Modal.html#~show">show</a></li></ul></li><li></li><li><a href="module-MoveablePopup.html">MoveablePopup</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-MoveablePopup.html#~checkXPosition">checkXPosition</a></li><li data-type='method' style='display: none;'><a href="module-MoveablePopup.html#~checkYPosition">checkYPosition</a></li></ul></li><li><a href="module-OmniSearch.html">OmniSearch</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-OmniSearch.html#~fireCustomQuery">fireCustomQuery</a></li><li data-type='method' style='display: none;'><a href="module-OmniSearch.html#~fireCustomQuery">fireCustomQuery</a></li><li data-type='method' style='display: none;'><a href="module-OmniSearch.html#~hide">hide</a></li><li data-type='method' style='display: none;'><a href="module-OmniSearch.html#~isSearchFilterButtonToggled">isSearchFilterButtonToggled</a></li></ul></li><li><a href="module-OmniSearch_widgets_OmniResult.html">OmniSearch/widgets/OmniResult</a></li><li><a href="module-OmniSearch_widgets_SearchFilterButton.html">OmniSearch/widgets/SearchFilterButton</a></li><li><a href="module-Popup.html">Popup</a></li><li><a href="module-Popup_widgets_PopupGrid.html">Popup/widgets/PopupGrid</a></li><li><a href="module-RadioBoxTable.html">RadioBoxTable</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-RadioBoxTable.html#~reset">reset</a></li><li data-type='method' style='display: none;'><a href="module-RadioBoxTable.html#~update">update</a></li><li data-type='method' style='display: none;'><a href="module-RadioBoxTable.html#~updateSelection">updateSelection</a></li></ul></li><li><a href="module-ResultsPane.html">ResultsPane</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-ResultsPane.html#~resizeResultsTable">resizeResultsTable</a></li></ul></li><li><a href="module-ResultsPane_widgets_AreaTemporalMetrics_widgets_ChartOptions.html">ResultsPane/widgets/AreaTemporalMetrics/widgets/ChartOptions</a></li><li><a href="module-ResultsPane_widgets_AreaTemporalMetrics_widgets_ChartTabs.html">ResultsPane/widgets/AreaTemporalMetrics/widgets/ChartTabs</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_AreaTemporalMetrics_widgets_ChartTabs.html#~getGraphData">getGraphData</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_AreaTemporalMetrics_widgets_ChartTabs.html#~initiateChart">initiateChart</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_AreaTemporalMetrics_widgets_ChartTabs.html#~updateCharts">updateCharts</a></li></ul></li><li><a href="module-ResultsPane_widgets_AreaTemporalMetrics_widgets_SpeedChart.html">ResultsPane/widgets/AreaTemporalMetrics/widgets/SpeedChart</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_AreaTemporalMetrics_widgets_SpeedChart.html#~createChart">createChart</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_AreaTemporalMetrics_widgets_SpeedChart.html#~prepData">prepData</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_AreaTemporalMetrics_widgets_SpeedChart.html#~update">update</a></li></ul></li><li><a href="module-ResultsPane_widgets_AreaTemporalMetrics_widgets_TemporalChart.html">ResultsPane/widgets/AreaTemporalMetrics/widgets/TemporalChart</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_AreaTemporalMetrics_widgets_TemporalChart.html#~createChart">createChart</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_AreaTemporalMetrics_widgets_TemporalChart.html#~prepData">prepData</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_AreaTemporalMetrics_widgets_TemporalChart.html#~update">update</a></li></ul></li><li><a href="module-ResultsPane_widgets_ExportCSV.html">ResultsPane/widgets/ExportCSV</a></li><li><a href="module-ResultsPane_widgets_ExportCrashRecords.html">ResultsPane/widgets/ExportCrashRecords</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_ExportCrashRecords.html#~enableSpinner">enableSpinner</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_ExportCrashRecords.html#~exportRecords">exportRecords</a></li></ul></li><li><a href="module-ResultsPane_widgets_FilterSummary.html">ResultsPane/widgets/FilterSummary</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_FilterSummary.html#~formatYearFilter">formatYearFilter</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_FilterSummary.html#~removeLabels">removeLabels</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_FilterSummary.html#~update">update</a></li></ul></li><li><a href="module-ResultsPane_widgets_ResultsGrid.html">ResultsPane/widgets/ResultsGrid</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_ResultsGrid.html#~compare_cty_code">compare_cty_code</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_ResultsGrid.html#~compare_muni_code">compare_muni_code</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_ResultsGrid.html#~exportCsv">exportCsv</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_ResultsGrid.html#~hide">hide</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_ResultsGrid.html#~removeDuplicateObjects">removeDuplicateObjects</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_ResultsGrid.html#~removeHighlight">removeHighlight</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_ResultsGrid.html#~resize">resize</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_ResultsGrid.html#~show">show</a></li><li data-type='method' style='display: none;'><a href="module-ResultsPane_widgets_ResultsGrid.html#~update">update</a></li></ul></li><li><a href="module-SettingsMenu.html">SettingsMenu</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-SettingsMenu.html#~disableClusterToggleButton">disableClusterToggleButton</a></li><li data-type='method' style='display: none;'><a href="module-SettingsMenu.html#~hide">hide</a></li><li data-type='method' style='display: none;'><a href="module-SettingsMenu.html#~show">show</a></li><li data-type='method' style='display: none;'><a href="module-SettingsMenu.html#~startTour">startTour</a></li></ul></li><li><a href="module-SettingsMenu_widgets_BasemapToggle.html">SettingsMenu/widgets/BasemapToggle</a></li><li><a href="module-SettingsMenu_widgets_ClusterToggle.html">SettingsMenu/widgets/ClusterToggle</a></li><li><a href="module-SettingsMenu_widgets_CrashClusterSelect.html">SettingsMenu/widgets/CrashClusterSelect</a></li><li><a href="module-SettingsMenu_widgets_MenuAnnotationToggle.html">SettingsMenu/widgets/MenuAnnotationToggle</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-SettingsMenu_widgets_MenuAnnotationToggle.html#~setAnnotationMode">setAnnotationMode</a></li></ul></li><li><a href="module-SettingsMenu_widgets_SignalsTourToggle_widgets_WelcomeTour.html">SettingsMenu/widgets/SignalsTourToggle/widgets/WelcomeTour</a></li><li><a href="module-SettingsMenu_widgets_TourToggle.html">SettingsMenu/widgets/TourToggle</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-SettingsMenu_widgets_TourToggle.html#~mouseEnterHandler">mouseEnterHandler</a></li><li data-type='method' style='display: none;'><a href="module-SettingsMenu_widgets_TourToggle.html#~mouseLeaveHandler">mouseLeaveHandler</a></li></ul></li><li><a href="module-SettingsMenu_widgets_UserManual.html">SettingsMenu/widgets/UserManual</a></li><li><a href="module-StatsExplorer.html">StatsExplorer</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~clear">clear</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~clearChart">clearChart</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~clearVehicleChartDivs">clearVehicleChartDivs</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~createChart">createChart</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~createPersonsSeverityChart">createPersonsSeverityChart</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~createSelect">createSelect</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~createVehicleModelChart">createVehicleModelChart</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~createVehiclesAttributeChart">createVehiclesAttributeChart</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~generateVehicleChartDivs">generateVehicleChartDivs</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~init">init</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~loading">loading</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~loadingDiv">loadingDiv</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~update">update</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~updateSeverityChart">updateSeverityChart</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~updateStatsChart">updateStatsChart</a></li><li data-type='method' style='display: none;'><a href="module-StatsExplorer.html#~updateVehicleMakeChart">updateVehicleMakeChart</a></li></ul></li><li><a href="module-StatsPane.html">StatsPane</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-StatsPane.html#~checkOpen">checkOpen</a></li><li data-type='method' style='display: none;'><a href="module-StatsPane.html#~init">init</a></li><li data-type='method' style='display: none;'><a href="module-StatsPane.html#~togglePane">togglePane</a></li><li data-type='method' style='display: none;'><a href="module-StatsPane.html#~update">update</a></li></ul></li><li><a href="module-Utilities.html">Utilities</a></li><li><a href="module-urls.html">urls</a></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">StatsPane/StatsExplorer/index.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import './stats-explorer.css';
import urls from '../../urls';
import API from '../../API';
import ApexCharts from 'apexcharts';

const api = new API();

/**
 * Creates a flyout div that contains statistic tables and charts for a specific crash segment.
 * @module StatsExplorer
 * @param {module} crashMap The Crash Map module.
 * @param {module} crashFilter The Crash Filter module.
 */
export default function StatsExplorer(crashMap, crashFilter) {
    let self = this;
    this.vehicleCharts = [];
    const chartId = "stats-chart";
    const selectId = "vehicle-filter-select";

    /**
     * An array of objects containing the filter options in the statistics pane.
     * When a user selects an option, the statistics charts and tables will automatically update based on the selected option.
     * @static 
     * @name filterOptions
     */
    const filterOptions = [
        {
            label: "Pre-Crash Action",
            value: "pre_crash_type",
            dataLabel: "Pre-Crash Action"
        },
        {
            label: "Special Function",
            value: "special_veh_code",
            dataLabel: "Special Function"
        },
        {
            label: "Vehicle Contributing Circumstances",
            value: "contr_circum_code_vehicles",
            dataLabel: "Contributing Circumstances 1"
        },
        {
            label: "Vehicle Type",
            value: "type_code",
            dataLabel: "Vehicle Type"
        },
        {
            label: "Traffic Control",
            value: "traf_cntrl_code",
            dataLabel: "Traffic Control"
        },
    ];
    let cardDiv = document.createElement("div");
    cardDiv.className = "card rounded-0";

    // Create the div with class "card-header" and add text "Featured"
    let cardHeaderDiv = document.createElement("div");
    cardHeaderDiv.className = "card-header fw-semibold";
    cardHeaderDiv.textContent = "Vehicles Attributes Explorer";

    // Create the div with class "card-body"
    let cardBodyDiv = document.createElement("div");
    cardBodyDiv.className = "card-body stats-card";

    // Create the p element with class "card-text" and add text "With supporting text below as a natural lead-in to additional content."
    let cardText = document.createElement("p");
    cardText.className = "card-text";
    cardText.textContent = `Select a vehicles-related filter from the dropdown below. Click on a data point in the statistics chart to update the Persons Severity and Vehicle Makes &amp; Models charts with the selected attribute.`;
    cardBodyDiv.appendChild(cardText);

    // Main statistics chart container
    let selectionContainerDiv = document.createElement("div");
    cardBodyDiv.appendChild(selectionContainerDiv);

    // Header and subtitle div for the Attributes chart
    let attributeHeader = document.createElement('h5');
    attributeHeader.classList = 'card-title mt-3';
    attributeHeader.innerHTML = 'Vehicle Attribute Breakdown';
    let attributeSubtitle = document.createElement('h6');
    attributeSubtitle.classList = 'card-subtitle text-body-secondary';
    attributeSubtitle.id = 'vehicle-attribute-subtitle';
    cardBodyDiv.append(attributeHeader, attributeSubtitle);
    
    let chartContainerDiv = document.createElement("div");
    chartContainerDiv.className = "stats-chart";
    chartContainerDiv.id = chartId;
    cardBodyDiv.appendChild(chartContainerDiv);

    // Second and third statistics chart container
    let secondaryContainerDiv = document.createElement("div");
    secondaryContainerDiv.className = 'container';

    let secondaryRowDiv = document.createElement("div");
    secondaryRowDiv.className = 'row';
    let personSeverityHeader = document.createElement('h5');
    personSeverityHeader.classList = 'card-title';
    personSeverityHeader.innerHTML = 'Persons Severity Breakdown';
    let personSeveritySubtitle = document.createElement('h6');
    personSeveritySubtitle.classList = 'card-subtitle mb-2 text-body-secondary';
    personSeveritySubtitle.id = 'person-severity-subtitle';
    secondaryRowDiv.append(personSeverityHeader, personSeveritySubtitle);

    let secondChartContainerDiv = document.createElement("div");
    secondChartContainerDiv.className = 'col persons-severity-chart';
    let secondChartDiv = document.createElement("div");
    secondChartDiv.id = chartId + "-2";
    secondChartContainerDiv.appendChild(secondChartDiv, personSeveritySubtitle);

    let thirdRowDiv = document.createElement("div");
    thirdRowDiv.className = 'row';
    let vehicleBreakdownHeader = document.createElement('h5');
    vehicleBreakdownHeader.classList = 'card-title';
    vehicleBreakdownHeader.innerHTML = 'Top Vehicle Makes &amp; Models';
    let vehicleBreakdownSubtitle = document.createElement('h6');
    vehicleBreakdownSubtitle.classList = 'card-subtitle mb-2 text-body-secondary';
    vehicleBreakdownSubtitle.id = 'vehicle-breakdown-subtitle';
    thirdRowDiv.append(vehicleBreakdownHeader, vehicleBreakdownSubtitle);

    let vehicleChartContainer = document.createElement("div");
    vehicleChartContainer.id = 'vehicle-chart-container'
    thirdRowDiv.append(vehicleChartContainer);

    secondaryContainerDiv.appendChild(secondaryRowDiv);
    secondaryRowDiv.appendChild(secondChartContainerDiv);
    cardBodyDiv.append(secondaryContainerDiv, thirdRowDiv);

    // Compile all divs together
    cardDiv.appendChild(cardBodyDiv);

    /**
     * Initializes the statistics pane by rendering the filter options dropdown and charts.
     * @date 2024-12-16
     * @function init
     */
    this.init = function () {
        const severityChart = createPersonsSeverityChart(chartId + "-2");
        self.personsSeverityChart = severityChart;
        const statsChart = createVehiclesAttributeChart(self, chartId, selectId, crashMap, crashFilter, severityChart, vehicleChartContainer, personSeveritySubtitle, vehicleBreakdownSubtitle);
        self.statsChart = statsChart;
        const selectElement = createSelect(self, selectId, filterOptions, crashMap, crashFilter, statsChart, attributeHeader, attributeSubtitle, chartContainerDiv);
        self.selectElement = selectElement;
        selectionContainerDiv.appendChild(selectElement);
        statsChart.render();
    }

    /**
     * Clears data from all charts.
     * @date 2024-12-16
     * @function clear
     * @param {boolean} clearAttributes=false If true, creates placeholder text in a chart stating that no data is returned.
     */
    this.clear = function(clearAttributes = false) {
        // Clear all charts
        clearChart(self.personsSeverityChart, "Generating chart...");
        personSeveritySubtitle.innerHTML = '';
        clearVehicleChartDivs(vehicleChartContainer);
        vehicleBreakdownSubtitle.innerHTML = '';

        if (clearAttributes) {
            clearChart(self.statsChart, "No data returned");
            attributeSubtitle.innerHTML = '';
        }
    }

    /**
     * Adds or removes the loading gif for each div containing a statistics table or chart.
     * @date 2024-12-16
     * @function loading
     * @param {boolean} isLoading If true, adds the `stats-loading` class to each div containing a statistics table or chart.
     * @param {boolean} updateAttributeTable=true If true, updates the loading gif for the statistics table.
     */
    this.loading = function(isLoading, updateAttributeTable = true) {
        if (isLoading) {
            if (updateAttributeTable) chartContainerDiv.classList.add('stats-loading');
            secondChartContainerDiv.classList.add('stats-loading');
            vehicleChartContainer.classList.add('stats-loading');
        }
        else {
            if (updateAttributeTable) chartContainerDiv.classList.remove('stats-loading');
            secondChartContainerDiv.classList.remove('stats-loading');
            vehicleChartContainer.classList.remove('stats-loading');
        }
    }

    /**
     * Updates the loading gif for a specific statistics chart container.
     * @date 2024-12-16
     * @function loadingDiv
     * @param {boolean} isLoading If true, adds the `stats-loading` class to each div containing a statistics table or chart.
     * @param {string} chartType A string determining which statistics chart to update. Values are: `severity`, `vehicle-make`.
     */
    this.loadingDiv = function(isLoading, chartType) {
        if (chartType == 'severity') {
            if (isLoading) secondChartContainerDiv.classList.add('stats-loading');
            else secondChartContainerDiv.classList.remove('stats-loading');
        }
        else if (chartType == 'vehicle-make') {
            if (isLoading) vehicleChartContainer.classList.add('stats-loading');
            else vehicleChartContainer.classList.remove('stats-loading');
        }
    }

    /**
     * Updates all statistics charts with crash data from `featureData`.
     * @date 2024-12-16
     * @function update
     * @param {object} featureData=undefined An object containing crash cluster or crash segment data.
     */
    this.update = function (featureData = undefined) {
        self.featureData = featureData;
        const selectElement = document.getElementById(selectId);
        let optionText = selectElement.options[selectElement.selectedIndex].text;
        const dataLabel = selectElement.options[selectElement.selectedIndex].getAttribute("dataLabel");

        let subtitleText = '';
        if (featureData.hasOwnProperty('sri')) subtitleText = `SRI: ${featureData['sri']} (Milepost ${featureData['mp_start']}-${featureData['mp_end']})`;
        else subtitleText = 'Selected Crash Cluster';

        // CLear all charts
        self.clear(true);
        self.loading(true);

        const filters = {
            statistics_parameter: selectElement.value,
        };

        if (featureData !== undefined) {
            if (featureData.hasOwnProperty('crash_array')) {
                filters['crash_array'] = JSON.stringify(featureData.crash_array);
                filters['selected_filters'] = '{}';
            }
            else {
                let crashFilters = crashFilter.getSelectedFilters();
                Object.entries(featureData).forEach(([key, value]) => {
                    crashFilters[key] = value;
                });    
                filters['selected_filters'] = JSON.stringify(crashFilters);
            }
        }
        
        let requestPromise = api.getData(urls.getVehicleStatisticsURL, filters);
        requestPromise.then((data) => {
            // console.log(data);
            if (data.statusCode === 500 || data === undefined) {
                clearChart(self.statsChart, "No data returned");
            }
            else {
                updateStatsChart(dataLabel, data, self.statsChart);
                attributeHeader.innerHTML = `Vehicle Attribute Breakdown: ${optionText}`;
                attributeSubtitle.innerHTML = subtitleText;
                chartContainerDiv.classList.remove('stats-loading');
                secondChartContainerDiv.classList.remove('stats-loading');
            }
        });

        // Update Persons Severity chart and Vehicle Model chart
        let requestPromiseSeverity = api.getData(urls.getVehiclePersonsSeverityURL, filters);
        requestPromiseSeverity.then((data) => {
            updateSeverityChart(data, self.personsSeverityChart, subtitleText, personSeveritySubtitle);
            secondChartContainerDiv.classList.remove('stats-loading');
        });

        let requestPromiseVehicles = api.getData(urls.getVehicleMakeModelURL, filters);
        requestPromiseVehicles.then((data) => {
            // Convert the object to an array of key-value pairs
            let entries = Object.entries(data);

            // Sort the array by the 'total' value
            entries.sort((a, b) => b[1].total - a[1].total);

            // Convert the sorted array back to an object
            let sortedData = Object.fromEntries(entries);

            // data = data.sort((a, b) => a.total - b.total);
            const vehicleData = generateVehicleChartDivs(vehicleChartContainer, sortedData);
            updateVehicleMakeChart(vehicleData, subtitleText, vehicleBreakdownSubtitle);
            vehicleChartContainer.classList.remove('stats-loading');
        });
    }

    this.domNode = cardDiv;
    return this;
}

/**
 * Creates a Persons Severity Chart using the ApexCharts framework based on the inputted HTML ID `chartId`.
 * @date 2024-12-16
 * @param {string} chartId The HTML ID of the chart that will contain the Persons Severity chart.
 * @returns {ApexChart} A rendered `ApexChart` chart.
 */
function createPersonsSeverityChart(chartId) {
    var options = {
        "series": [],
        "xaxis": {
            "categories": ["Occupants", "Pedestrians", "Pedacyclists"]
        },
        chart: {
            type: 'bar',
            height: 350,
            stacked: true,
            toolbar: {
                show: true
            }
        },
        plotOptions: {
            bar: {
                horizontal: false,
                dataLabels: {
                    total: {
                        enabled: true,
                        offsetX: 0,
                        style: {
                            fontSize: '13px',
                            fontWeight: 900
                        }
                    }
                }
            },
        },
        stroke: {
            width: 1,
            colors: ['#fff']
        },
        legend: {
            position: 'right',
            offsetY: 40
        },
        colors: ['#dc3545', '#ffc107', '#20c997', '#0d6efd'],
        grid: {
            show: false
        }
    };
    let chart = new ApexCharts(document.querySelector("#" + chartId), options);
    chart.render();
    return chart;
}

/**
 * Generates div elements that will contain vehicle make statistic donut charts.
 * The number of columns is 2 and the number of rows is based on the number of vehicle makes in `data`.
 * @date 2024-12-16
 * @param {domNode} containerDiv
 * @param {object} data An object containing vehicle make and count.
 * @returns {object} An object containing vehicle make and count.
 */
function generateVehicleChartDivs(containerDiv, data) {
    clearVehicleChartDivs(containerDiv);

    let chartCount = 1;
    let chartRowDiv;      // create new row div

    Object.keys(data).forEach(function(key, index) {
        const vehicleData = data[key];
        const id = 'vehicle-chart-' + index;
        vehicleData["divId"] = id;

    
        // on odd chart counts, create a new row div and add the chart into the row div
        if (chartCount % 2 == 1) {
            chartRowDiv = document.createElement('div');      // create new row div
            chartRowDiv.classList = 'row vehicle-make-model-chart';
        }

        const chartDiv = document.createElement('div');     // create chart div
        chartDiv.classList = 'col';
        chartDiv.id = id;
        chartRowDiv.appendChild(chartDiv);      // add the chart into the row div

        // on even chart counts, add the chart then add the row div to the container div
        if (chartCount % 2 == 0) {
            containerDiv.appendChild(chartRowDiv);
        }

        // if the last index is odd, then add the row div to the container
        if (index == Object.keys(data).length - 1 &amp;&amp; chartCount % 2 == 1)  {
            containerDiv.appendChild(chartRowDiv);
        }
        chartCount++;
    });

    return data;
}

/**
 * Creates donut charts that depict a vehicle make and subcategories for the models within the brand. Each donut slice represents the number of vehicles within a brand.
 * @date 2024-12-16
 * @param {string} make The vehicle make brand name.
 * @param {object} vehicleData An object containing an array of `labels` which list models within the car brand and an array of `values` or counts of each model.
 * @returns {ApexChart} A rendered vehicle model chart as a donut chart using the `ApexCharts` framework.
 * @example
 * let vehicleMakeData = {
 * "CHEVROLET": {
        "labels": [
            "SIL",
            "SON"
        ],
        "values": [
            1,
            1
        ],
        "total": 2
    }, ...
 * };
 *  createVehicleModelChart("CHEVROLET", vehicleMakeData["CHEVROLET"]);
 */
function createVehicleModelChart(make, vehicleData) {
    let series = [];
    let labels = [];

    if (vehicleData) {
        series = vehicleData["values"];
        labels = vehicleData["labels"];
    }
    let options = {
        series: series,
        labels: labels ,
        chart: {
            type: 'donut',
            height: 250,
            // offsetX: -100,
            width: 300
        },
        plotOptions: {
            pie: {
                startAngle: -90,
                endAngle: 90,
                offsetY: 10,
                donut: {
                    labels: {
                        show: true,
                        label: make,
                        name: {
                            offsetY: -35,
                        },
                        value: {
                            offsetY: -20,
                        },
                        total: {
                            showAlways: true,
                            show: true,
                            label: make,
                            offsetY: -25,
                        }
                    }
                }
            }
        },
        dataLabels: {
            formatter(val, opts) {
              const name = opts.w.globals.labels[opts.seriesIndex]
              return [name, val.toFixed(1) + '%']
            }
        },
        legend: {
            show: false
        }
    };

    let chart = new ApexCharts(document.querySelector("#" + vehicleData["divId"]), options);
    chart.render();
    return chart;
}

/**
 * Creates a select div and renders dropdown options for vehicle-specific filters based on the inputted `filterOptions`. 
 * Handles the event when a user selects a filter option from the dropdown by updating the Vehicle Attribute Breakdown bar chart with the selected Vehicle filter.
 * @date 2024-12-16
 * @param {module} statsExplorer The Statistics Explorer module.
 * @param {string} selectId The ID of the filter select div.
 * @param {object[]} filterOptions An array of objects containing the filter options in the statistics pane.
 * @param {module} crashMap The Crash Map module.
 * @param {module} crashFilter The Crash Filter module.
 * @param {ApexChart} apexChart The Persons Severity chart.
 * @param {domNode} attributeHeader The header div for the Persons Severity chart.
 * @param {domNode} attributeSubtitle The subtitle div for the Persons Severity chart.
 * @param {domNode} chartContainerDiv The div container for the Persons Severity chart.
 * @returns {domNode} The rendered select element.
 */
function createSelect(statsExplorer, selectId, filterOptions, crashMap, crashFilter, apexChart, attributeHeader, attributeSubtitle, chartContainerDiv) {
    let selectElement = document.createElement("select");
    selectElement.classList = 'form-select';
    
    // Set attributes for the select element
    selectElement.id = selectId;

    for (let index = 0; index &lt; filterOptions.length; index++) {
        const option = filterOptions[index];
        let optionEl = document.createElement("option");
        optionEl.text = option.label;
        if (option.value) optionEl.value = option.value;
        if (option.dataLabel) optionEl.setAttribute("dataLabel", option.dataLabel);
        if (index == 0) optionEl.setAttribute("selected", "true");
        selectElement.appendChild(optionEl);
    }

    selectElement.addEventListener('change', function (e) {
        // CLear chart
        clearChart(apexChart);
        chartContainerDiv.classList.add('stats-loading');
        attributeHeader.innerHTML = `Vehicle Attribute Breakdown`;

        const optionText = selectElement.options[selectElement.selectedIndex].text;
        const dataLabel = selectElement.options[selectElement.selectedIndex].getAttribute("dataLabel");

        const filters = {
            statistics_parameter: this.value,
        };

        if (statsExplorer.featureData !== undefined) {
            if (statsExplorer.featureData.hasOwnProperty('crash_array')) {
                filters['crash_array'] = JSON.stringify(statsExplorer.featureData.crash_array);
                filters['selected_filters'] = '{}';
            }
            else {
                let crashFilters = crashFilter.getSelectedFilters();
                Object.entries(statsExplorer.featureData).forEach(([key, value]) => {
                    crashFilters[key] = value;
                });
                filters['selected_filters'] = JSON.stringify(crashFilters);
            }
        }

        let requestPromise = api.getData(urls.getVehicleStatisticsURL, filters);
        requestPromise.then((data) => {
            attributeHeader.innerHTML = `Vehicle Attribute Breakdown: ${optionText}`;
            if (statsExplorer.featureData.hasOwnProperty('sri')) attributeSubtitle.innerHTML = `SRI: ${statsExplorer.featureData['sri']} (Milepost ${statsExplorer.featureData['mp_start']}-${statsExplorer.featureData['mp_end']})`;
            else attributeSubtitle.innerHTML = 'Selected Crash Cluster';
            updateStatsChart(dataLabel, data, apexChart);
            chartContainerDiv.classList.remove('stats-loading');
        });
    });

    return selectElement;
}

/**
 * Creates a horizontal bar chart displaying vehicle attributes within a crash segment.
 * Clicking on an attribute bar will filter the Persons Severity bar chart and Vehicle Makes &amp; Models donut charts with the selected attribute.
 * Re-selecting the same attribute will remove the filter and display all charts without filters.
 * @date 2024-12-16
 * @param {module} statsExplorer The Statistics Explorer module.
 * @param {string} containerId The ID of the container div where the Vehicle Attribute chart will be rendered in.
 * @param {string} selectId The ID of the filter select div.
 * @param {module} crashMap The Crash Map module.
 * @param {module} crashFilter The Crash Filter module.
 * @param {ApexChart} severityChart The Persons Severity bar chart object.
 * @param {domNode} vehicleChartContainer The div containing the Vehicle Makes and Models charts.
 * @param {domNode} severitySubtextDiv The div containing the SRI and milepost subtext for the Persons Severity chart.
 * @param {domNode} vehicleSubtextDiv The div containing the SRI and milepost subtext for the Vehicle Makes and Models charts.
 * @returns {ApexChart} A horizontal bar chart displaying vehicle attributes within a crash segment.
 */
function createVehiclesAttributeChart(statsExplorer, containerId, selectId, crashMap, crashFilter, severityChart, vehicleChartContainer, severitySubtextDiv, vehicleSubtextDiv) {
    let seriesOption = {
        name: 'Vehicle Count',
        data: []
    };
    let xAxisOptions = {
        categories: []
    };

    let options = {
        series: [seriesOption],
        xaxis: xAxisOptions,
        chart: {
            type: 'bar',
            height: 350,
            selection: {
                enabled: true,
                xaxis: {
                    min: 0,
                    max: 0
                },
                yaxis: {
                    min: 0,
                    max: 0
                }
            },
            events: {
                dataPointSelection: function (e, sourceChart, opts) {
                    // CLear all charts
                    statsExplorer.clear(false);
                    statsExplorer.loading(true, false);

                    const selectElement = document.getElementById(selectId);
                    let subtitleText = '';
                    if (statsExplorer.featureData.hasOwnProperty('sri')) subtitleText = `SRI: ${statsExplorer.featureData['sri']} (Milepost ${statsExplorer.featureData['mp_start']}-${statsExplorer.featureData['mp_end']})`;
                    else subtitleText = 'Selected Crash Cluster';
                    // Process filters for the API query

                    let filters = {};
                    if (statsExplorer.featureData !== undefined) {
                        if (statsExplorer.featureData.hasOwnProperty('crash_array')) {
                            filters['crash_array'] = JSON.stringify(statsExplorer.featureData.crash_array);
                            filters['selected_filters'] = '{}';
                        }
                        else {
                            let crashFilters = crashFilter.getSelectedFilters();
                            Object.entries(statsExplorer.featureData).forEach(([key, value]) => {
                                crashFilters[key] = value;
                            });
                            filters['selected_filters'] = JSON.stringify(crashFilters);
                        }
                    }

                    if (opts.selectedDataPoints[0].length === 1) {
                        if (sourceChart.w.globals.selectedDataPoints[0]) {
                            let selectedPoints = sourceChart.w.globals.selectedDataPoints;

                            // Clear subtitle texts
                            severitySubtextDiv.innerHTML = '';
                            vehicleSubtextDiv.innerHTML = '';

                            let seriesIndex = 0;
                            for (let i = 0; i &lt; selectedPoints[seriesIndex].length; i++) {
                                let selectedIndex = selectedPoints[seriesIndex][i];
                                let selectedValue = sourceChart.w.config.xaxis.categories[selectedIndex];
                                subtitleText += `&lt;br /> Vehicle Attribute: ${selectedValue}`;

                                // Process filters for the API query
                                // filters = {
                                //     fieldName: selectElement.value,
                                //     fieldDescription: selectedValue,
                                //     // selected_filters: JSON.stringify(crashFilters)
                                // };
                                filters['fieldName'] = selectElement.value;
                                filters['fieldDescription'] = selectedValue;
                            }
                        }
                    }

                    let requestPromise = api.getData(urls.getVehiclePersonsSeverityURL, filters);
                    requestPromise.then((data) => {
                        // console.log(data);
                        updateSeverityChart(data, severityChart, subtitleText, severitySubtextDiv);
                        statsExplorer.loadingDiv(false, 'severity');
                    });

                    let requestPromiseVehicles = api.getData(urls.getVehicleMakeModelURL, filters);
                    requestPromiseVehicles.then((data) => {
                        // Convert the object to an array of key-value pairs
                        let entries = Object.entries(data);

                        // Sort the array by the 'total' value
                        entries.sort((a, b) => b[1].total - a[1].total);

                        // Convert the sorted array back to an object
                        let sortedData = Object.fromEntries(entries);
                        // console.log(data);
                        const vehicleData = generateVehicleChartDivs(vehicleChartContainer, sortedData);
                        updateVehicleMakeChart(vehicleData, subtitleText, vehicleSubtextDiv);
                        statsExplorer.loadingDiv(false, 'vehicle-make');
                    });

                }
            }
        },
        plotOptions: {
            bar: {
                borderRadius: 4,
                horizontal: true,
                dataLabels: {
                    position: 'bottom',
                }
            }
        },
        dataLabels: {
            enabled: true,
            offsetX: 3,
            style: {
              fontSize: '12px',
            }
        },
        title: {
            align: 'center',
        },
        animations: {
            enabled: true,
            easing: 'easeinout',
            speed: 800,
            animateGradually: {
                enabled: true,
                delay: 150
            },
            dynamicAnimation: {
                enabled: true,
                speed: 350
            }
        }
    }
    const vehiclesChart = createChart(containerId, options);
    return vehiclesChart;
}

/**
 * Creates an `ApexChart` based on a container div ID and an object of chart options.
 * @date 2024-12-16
 * @param {string} containerId The HTML div ID where the chart will be rendered in.
 * @param {object} chartOptions An object containing chart options.
 * @returns {ApexChart} A rendered chart.
 */
function createChart(containerId, chartOptions) {
    let chart = new ApexCharts(document.querySelector("#" + containerId), chartOptions);
    return chart;
}

/**
 * Removes current data in a chart and sets x and y axis values to 0.
 * @date 2024-12-16
 * @param {ApexChart} apexChart The chart to clear data from.
 */
function clearChart(apexChart) {
    const selectedPoints = apexChart.w.globals.selectedDataPoints;
    for (let series = 0; series &lt; selectedPoints.length; series++) {
        const point = selectedPoints[series];
        apexChart.toggleDataPointSelection(series, point);
    }
    // if (selectedPoints.length > 0) apexChart.toggleDataPointSelection(0, selectedPoints[0]);

    apexChart.updateSeries([
        {
            data: []
        }
    ]);

    apexChart.updateOptions({
        xaxis: {
            categories: []
        },
        title: {
            text: "",
        },
        chart: {
            selection: {
                xaxis: {
                    min: 0,
                    max: 0
                },
                yaxis: {
                    min: 0,
                    max: 0
                }
            }
        },
        animations: {
            enabled: true,
            easing: 'easeinout',
            speed: 800,
            animateGradually: {
                enabled: true,
                delay: 150
            },
            dynamicAnimation: {
                enabled: true,
                speed: 350
            }
        },
        grid: {
            show: false
        }
    });
}

/**
 * Clears all child elements from the specified container div.
 *
 * @param {HTMLElement} containerDiv - The HTML element from which all child elements will be removed.
 */
function clearVehicleChartDivs(containerDiv) {
    for (var i = containerDiv.children.length - 1; i >= 0; i--) {
        var child = containerDiv.children[i];
        containerDiv.removeChild(child);
    }
}

/**
 * Updates a statistics chart with new data and categories.
 *
 * @param {string} dataLabel - The key used to extract category labels from the chart data.
 * @param {object[]} chartData - An array of objects containing data points, where each object includes a count and a label.
 * @param {object} apexChart - The ApexCharts instance to update.
 */
function updateStatsChart(dataLabel, chartData, apexChart) {
    let newSeriesData = [];
    let newCategories = [];

    for (let index = 0; index &lt; chartData.length; index++) {
        const dataPoint = chartData[index];
        newSeriesData.push(dataPoint.count);
        newCategories.push(dataPoint[dataLabel]);
    }

    apexChart.updateOptions({
        series: [{
            data: newSeriesData
        }],
        xaxis: {
            categories: newCategories,
            text: 'Vehicle Count'
        }
    });
}

/**
 * Updates the severity chart with new data and modifies the subtitle text.
 *
 * @param {Object} chartData - The data to update the chart with, including series and x-axis values.
 * @param {Object} apexChart - The ApexCharts instance to update.
 * @param {string} subtitleText - The text to display as the chart's subtitle.
 * @param {HTMLElement} subtextDiv - The HTML element where the subtitle text will be updated.
 */
function updateSeverityChart(chartData, apexChart, subtitleText, subtextDiv) {
    apexChart.updateOptions({
        series: chartData.series,
        xaxis: chartData.xaxis,
        grid: {
            show: true
        }
    });

    subtextDiv.innerHTML = subtitleText;
}

/**
 * Updates the vehicle make chart with new data and modifies the subtitle text.
 *
 * @param {Object} chartData - An object containing vehicle make data, where keys are vehicle makes and values are the corresponding data.
 * @param {string} subtitleText - The text to display as the chart's subtitle.
 * @param {HTMLElement} subtextDiv - The HTML element where the subtitle text will be updated.
 */
function updateVehicleMakeChart(chartData, subtitleText, subtextDiv) {
    Object.keys(chartData).forEach(function(key, index) {
        const vehicleData = chartData[key];
        createVehicleModelChart(key, vehicleData);
    });

    subtextDiv.innerHTML = subtitleText;
}</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.4</a> on Tue Dec 17 2024 10:18:34 GMT-0500 (Eastern Standard Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>


<script src="scripts/collapse.js" defer></script>


</body>
</html>
